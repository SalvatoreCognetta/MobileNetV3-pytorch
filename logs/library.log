[2022-01-18 15:58:19,463 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 15:58:19,466 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/main.py", line 21, in run
    mod = importlib.import_module(mod_name)
  File "/home/doni-lab-ai/miniconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 855, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 3, in <module>
    import torch
ModuleNotFoundError: No module named 'torch'
[2022-01-18 15:58:33,955 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 15:58:35,992 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 15:58:36,002 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 15:58:36,556 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 15:58:36,556 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 35, in run
    SEED = int(conf['deterministic']['seed'])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/configparser.py", line 960, in __getitem__
    raise KeyError(key)
KeyError: 'deterministic'
[2022-01-18 15:59:14,599 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 15:59:15,554 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 15:59:15,566 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 15:59:15,931 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 15:59:15,933 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 15:59:15,933 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 15:59:15,934 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 70, in run
    train_loader, valid_loader = setup_cifar10(cifar_path, BATCH_SIZE, NUM_WORKERS)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/data.py", line 31, in setup_cifar10
    train_dataset = torchvision.datasets.CIFAR10(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torchvision/datasets/cifar.py", line 68, in __init__
    raise RuntimeError('Dataset not found or corrupted.' +
RuntimeError: Dataset not found or corrupted. You can use download=True to download it
[2022-01-18 16:00:24,983 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:00:25,920 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:00:25,930 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:00:26,243 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:00:26,244 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:00:26,244 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:00:27,331 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 145, in run
    model = MobileNetV3Module(hparams, rgb_img, mode=args.mode)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 236, in __init__
    self.net = MobileNetV3(self.hparams.num_classes, self.hparams.dropout, self.rgb_img, self.mode)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 163, in __init__
    self.bneck_specs = self.load_bneck_specs()
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 195, in load_bneck_specs
    with open(self.spec_file, "r") as spec_f:
FileNotFoundError: [Errno 2] No such file or directory: '../specification/mobilenetv3-large.json'
[2022-01-18 16:01:14,992 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:01:15,942 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:01:15,952 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:01:16,257 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:01:16,258 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:01:16,259 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:01:17,338 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:01:17,338 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:01:17,338 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:01:17,338 INFO @src.logger.base_logger] 153 - Precision: 32
[2022-01-18 16:01:17,338 INFO @src.logger.base_logger] 154 - Train the mobilenetv3 model.
[2022-01-18 16:01:17,403 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:01:18,364 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:01:18,373 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:01:18,668 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:01:18,669 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:01:18,669 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:01:19,121 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:01:19,127 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:01:20,063 INFO @src.logger.base_logger] 153 - Precision: 32
[2022-01-18 16:01:20,063 INFO @src.logger.base_logger] 154 - Train the mobilenetv3 model.
[2022-01-18 16:01:20,064 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:01:20,065 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:01:20,065 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:01:20,066 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:01:20,067 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:01:20,067 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:01:20,076 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:01:25,199 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:01:25,199 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:01:25,306 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:01:25,445 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:01:25,494 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:01:25,502 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:01:25,522 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:01:28,884 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-18 16:01:35,960 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:01:35,961 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:02:28,110 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 1] Metric val_Accuracy improved. New best score: 0.100
[2022-01-18 16:02:28,111 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 0] Metric val_Accuracy improved. New best score: 0.100
[2022-01-18 16:06:35,980 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 1] Monitored metric val_Accuracy did not improve in the last 5 records. Best score: 0.100. Signaling Trainer to stop.
[2022-01-18 16:06:35,980 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 0] Monitored metric val_Accuracy did not improve in the last 5 records. Best score: 0.100. Signaling Trainer to stop.
[2022-01-18 16:06:36,155 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:06:36,165 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-18 16:06:36,180 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  318.84         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  50.001         	|6              	|  300.01         	|  94.094         	|
run_training_batch                 	|  0.39664        	|588            	|  233.22         	|  73.148         	|
model_forward                      	|  0.37794        	|588            	|  222.23         	|  69.7           	|
training_step                      	|  0.37784        	|588            	|  222.17         	|  69.681         	|
closure_0                          	|  0.25493        	|588            	|  149.9          	|  47.015         	|
get_train_batch                    	|  0.055336       	|588            	|  32.538         	|  10.205         	|
evaluation_step_and_end            	|  0.10271        	|122            	|  12.53          	|  3.93           	|
validation_step                    	|  0.10258        	|122            	|  12.514         	|  3.9251         	|
on_train_epoch_end                 	|  0.033392       	|6              	|  0.20035        	|  0.062838       	|
training_batch_to_device           	|  0.00025432     	|588            	|  0.14954        	|  0.046901       	|
on_train_batch_end                 	|  0.0002386      	|588            	|  0.1403         	|  0.044003       	|
on_after_backward                  	|  8.046e-05      	|588            	|  0.04731        	|  0.014839       	|
on_before_optimizer_step           	|  6.3025e-05     	|588            	|  0.037058       	|  0.011623       	|
evaluation_batch_to_device         	|  0.00027262     	|122            	|  0.03326        	|  0.010432       	|
on_validation_batch_end            	|  0.00021064     	|122            	|  0.025698       	|  0.00806        	|
on_before_backward                 	|  3.4502e-05     	|588            	|  0.020287       	|  0.0063628      	|
on_batch_start                     	|  3.017e-05      	|588            	|  0.01774        	|  0.005564       	|
on_train_batch_start               	|  2.6833e-05     	|588            	|  0.015778       	|  0.0049486      	|
on_batch_end                       	|  2.3624e-05     	|588            	|  0.013891       	|  0.0043567      	|
on_validation_end                  	|  0.0019217      	|7              	|  0.013452       	|  0.0042191      	|
training_step_end                  	|  1.9672e-05     	|588            	|  0.011567       	|  0.0036278      	|
on_train_start                     	|  0.0099764      	|1              	|  0.0099764      	|  0.003129       	|
on_validation_batch_start          	|  4.6256e-05     	|122            	|  0.0056432      	|  0.0017699      	|
on_train_epoch_start               	|  0.00077994     	|6              	|  0.0046796      	|  0.0014677      	|
on_validation_start                	|  0.00060825     	|7              	|  0.0042578      	|  0.0013354      	|
validation_step_end                	|  2.1531e-05     	|122            	|  0.0026268      	|  0.00082386     	|
on_train_end                       	|  0.00066246     	|1              	|  0.00066246     	|  0.00020778     	|
on_epoch_end                       	|  4.4522e-05     	|13             	|  0.00057879     	|  0.00018153     	|
on_validation_epoch_end            	|  6.6254e-05     	|7              	|  0.00046378     	|  0.00014546     	|
on_epoch_start                     	|  3.3295e-05     	|13             	|  0.00043283     	|  0.00013575     	|
on_validation_epoch_start          	|  2.3538e-05     	|7              	|  0.00016476     	|  5.1676e-05     	|
on_fit_start                       	|  6.3337e-05     	|1              	|  6.3337e-05     	|  1.9865e-05     	|
on_train_dataloader                	|  3.6638e-05     	|1              	|  3.6638e-05     	|  1.1491e-05     	|
on_val_dataloader                  	|  2.3423e-05     	|1              	|  2.3423e-05     	|  7.3465e-06     	|
on_before_accelerator_backend_setup	|  1.018e-05      	|1              	|  1.018e-05      	|  3.193e-06      	|

[2022-01-18 16:10:32,725 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:10:33,654 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:10:33,664 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:10:33,978 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:10:33,979 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:10:33,979 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:10:34,084 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:10:34,084 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:10:34,084 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:10:34,085 INFO @src.logger.base_logger] 153 - Precision: 32
[2022-01-18 16:10:34,085 INFO @src.logger.base_logger] 154 - Train the mobilenetv3 model.
[2022-01-18 16:10:34,148 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:10:35,101 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:10:35,115 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:10:35,457 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:10:35,458 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:10:35,458 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:10:35,562 INFO @src.logger.base_logger] 153 - Precision: 32
[2022-01-18 16:10:35,562 INFO @src.logger.base_logger] 154 - Train the mobilenetv3 model.
[2022-01-18 16:10:35,562 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:10:35,564 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:10:35,865 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:10:35,868 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:10:36,565 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:10:36,568 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:10:36,568 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:10:36,568 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:10:36,576 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:10:40,426 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:10:40,427 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:10:40,525 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:10:40,683 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:10:40,690 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:10:40,695 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:10:40,701 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:10:43,821 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.141    Total estimated model params size (MB)
[2022-01-18 16:10:46,769 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:10:46,770 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:11:41,135 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 0] Metric train_Accuracy improved. New best score: 0.167
[2022-01-18 16:11:41,135 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 1] Metric train_Accuracy improved. New best score: 0.062
[2022-01-18 16:12:36,325 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 1] Metric train_Accuracy improved by 0.042 >= min_delta = 0.001. New best score: 0.104
[2022-01-18 16:13:31,171 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 1] Metric train_Accuracy improved by 0.021 >= min_delta = 0.001. New best score: 0.125
[2022-01-18 16:16:16,052 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 0] Monitored metric train_Accuracy did not improve in the last 5 records. Best score: 0.167. Signaling Trainer to stop.
[2022-01-18 16:17:10,797 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 0] Monitored metric train_Accuracy did not improve in the last 6 records. Best score: 0.167. Signaling Trainer to stop.
[2022-01-18 16:18:05,520 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 1] Monitored metric train_Accuracy did not improve in the last 5 records. Best score: 0.125. Signaling Trainer to stop.
[2022-01-18 16:18:05,520 INFO @pytorch_lightning.callbacks.early_stopping] 267 - [rank: 0] Monitored metric train_Accuracy did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
[2022-01-18 16:18:05,702 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:18:05,709 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-18 16:18:05,720 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  451.63         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  54.832         	|8              	|  438.65         	|  97.127         	|
run_training_batch                 	|  0.37411        	|944            	|  353.16         	|  78.197         	|
model_forward                      	|  0.36791        	|944            	|  347.31         	|  76.901         	|
training_step                      	|  0.36781        	|944            	|  347.21         	|  76.879         	|
closure_0                          	|  0.24817        	|944            	|  234.28         	|  51.874         	|
get_train_batch                    	|  0.03394        	|944            	|  32.039         	|  7.0941         	|
evaluation_step_and_end            	|  0.09728        	|162            	|  15.759         	|  3.4894         	|
validation_step                    	|  0.097179       	|162            	|  15.743         	|  3.4858         	|
training_batch_to_device           	|  0.0128         	|944            	|  12.083         	|  2.6755         	|
evaluation_batch_to_device         	|  0.012691       	|162            	|  2.056          	|  0.45523        	|
on_train_batch_end                 	|  0.00022625     	|944            	|  0.21358        	|  0.047292       	|
on_train_epoch_end                 	|  0.025023       	|8              	|  0.20019        	|  0.044326       	|
on_after_backward                  	|  8.0592e-05     	|944            	|  0.076079       	|  0.016846       	|
on_before_optimizer_step           	|  5.8102e-05     	|944            	|  0.054849       	|  0.012145       	|
on_validation_batch_end            	|  0.0002485      	|162            	|  0.040257       	|  0.0089136      	|
on_before_backward                 	|  3.5555e-05     	|944            	|  0.033564       	|  0.0074317      	|
on_batch_start                     	|  3.2579e-05     	|944            	|  0.030754       	|  0.0068096      	|
on_train_batch_start               	|  2.9692e-05     	|944            	|  0.028029       	|  0.0062062      	|
on_batch_end                       	|  2.3483e-05     	|944            	|  0.022168       	|  0.0049085      	|
training_step_end                  	|  1.8412e-05     	|944            	|  0.017381       	|  0.0038484      	|
on_validation_end                  	|  0.0018176      	|9              	|  0.016359       	|  0.0036222      	|
on_train_epoch_start               	|  0.0020343      	|8              	|  0.016274       	|  0.0036034      	|
on_train_start                     	|  0.0085135      	|1              	|  0.0085135      	|  0.0018851      	|
on_validation_batch_start          	|  4.0931e-05     	|162            	|  0.0066309      	|  0.0014682      	|
on_validation_start                	|  0.00063056     	|9              	|  0.005675       	|  0.0012566      	|
validation_step_end                	|  2.0896e-05     	|162            	|  0.0033851      	|  0.00074953     	|
on_epoch_end                       	|  3.9956e-05     	|17             	|  0.00067925     	|  0.0001504      	|
on_epoch_start                     	|  3.339e-05      	|17             	|  0.00056763     	|  0.00012568     	|
on_validation_epoch_end            	|  5.7464e-05     	|9              	|  0.00051718     	|  0.00011451     	|
on_train_end                       	|  0.00046079     	|1              	|  0.00046079     	|  0.00010203     	|
on_validation_epoch_start          	|  2.4213e-05     	|9              	|  0.00021792     	|  4.8251e-05     	|
on_fit_start                       	|  5.9832e-05     	|1              	|  5.9832e-05     	|  1.3248e-05     	|
on_train_dataloader                	|  4.7906e-05     	|1              	|  4.7906e-05     	|  1.0607e-05     	|
on_val_dataloader                  	|  2.7606e-05     	|1              	|  2.7606e-05     	|  6.1125e-06     	|
on_before_accelerator_backend_setup	|  9.8543e-06     	|1              	|  9.8543e-06     	|  2.182e-06      	|

[2022-01-18 16:27:49,138 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:27:50,098 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:27:50,108 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:27:50,405 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:27:50,406 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:27:50,406 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:27:51,346 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:27:51,346 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:27:51,346 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:27:51,346 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:27:51,346 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:27:51,414 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:27:52,538 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:27:52,549 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:27:52,908 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:27:52,909 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:27:52,909 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:27:53,133 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:27:53,136 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:27:53,929 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:27:53,929 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:27:53,930 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:27:53,931 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:27:53,932 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:27:53,942 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:27:53,943 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:27:53,943 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:27:53,943 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:27:58,168 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:27:58,170 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:27:58,254 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:27:58,422 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:27:58,435 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:27:58,443 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:27:58,449 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:28:01,911 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-18 16:28:07,624 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:28:07,627 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:28:18,090 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 133, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
RuntimeError: CUDA out of memory. Tried to allocate 184.00 MiB (GPU 1; 23.65 GiB total capacity; 21.80 GiB already allocated; 49.00 MiB free; 21.89 GiB reserved in total by PyTorch)
[2022-01-18 16:28:19,174 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 127, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 54, in forward
    return F.relu6(x + 3, inplace=self.inplace) / 6
RuntimeError: CUDA out of memory. Tried to allocate 78.00 MiB (GPU 0; 23.65 GiB total capacity; 17.70 GiB already allocated; 11.94 MiB free; 17.74 GiB reserved in total by PyTorch)
[2022-01-18 16:29:29,728 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:29:30,687 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:29:30,700 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:29:31,007 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:29:31,008 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:29:31,008 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:29:31,961 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:29:31,961 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:29:31,961 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:29:31,961 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:29:31,961 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:29:32,032 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:29:33,008 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:29:33,018 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:29:33,317 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:29:33,318 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:29:33,319 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:29:33,749 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:29:33,752 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:29:34,373 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:29:34,373 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:29:34,374 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:29:34,376 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:29:34,376 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:29:34,379 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:29:34,379 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:29:34,380 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:29:34,387 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:29:38,548 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:29:38,549 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:29:38,658 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:29:38,813 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:29:38,820 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:29:38,828 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:29:38,834 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:29:41,990 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-18 16:29:48,493 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:29:48,495 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:30:01,468 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 127, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 54, in forward
    return F.relu6(x + 3, inplace=self.inplace) / 6
RuntimeError: CUDA out of memory. Tried to allocate 78.00 MiB (GPU 0; 23.65 GiB total capacity; 17.70 GiB already allocated; 3.94 MiB free; 17.74 GiB reserved in total by PyTorch)
[2022-01-18 16:30:02,604 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 133, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
RuntimeError: CUDA out of memory. Tried to allocate 184.00 MiB (GPU 1; 23.65 GiB total capacity; 21.80 GiB already allocated; 40.81 MiB free; 21.89 GiB reserved in total by PyTorch)
[2022-01-18 16:31:18,832 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:31:19,778 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:31:19,788 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:31:20,118 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:31:20,119 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:31:20,119 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:31:21,064 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:31:21,064 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:31:21,064 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:31:21,065 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:31:21,065 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:31:21,129 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:31:22,092 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:31:22,103 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:31:22,399 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:31:22,400 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:31:22,400 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:31:22,851 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:31:22,854 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:31:23,374 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:31:23,374 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:31:23,374 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:31:23,376 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:31:23,376 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:31:23,379 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:31:23,379 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:31:23,380 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:31:23,391 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:31:27,247 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:31:27,247 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:31:27,332 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:31:27,475 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:31:27,481 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:31:27,486 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:31:27,492 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:31:30,615 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-18 16:31:36,555 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:31:36,558 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:31:47,803 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 133, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
RuntimeError: CUDA out of memory. Tried to allocate 184.00 MiB (GPU 1; 23.65 GiB total capacity; 21.80 GiB already allocated; 46.44 MiB free; 21.89 GiB reserved in total by PyTorch)
[2022-01-18 16:31:50,654 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 127, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 54, in forward
    return F.relu6(x + 3, inplace=self.inplace) / 6
RuntimeError: CUDA out of memory. Tried to allocate 78.00 MiB (GPU 0; 23.65 GiB total capacity; 17.63 GiB already allocated; 79.94 MiB free; 17.66 GiB reserved in total by PyTorch)
[2022-01-18 16:32:51,320 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:32:52,267 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:32:52,277 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:32:52,567 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:32:52,568 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:32:52,569 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:32:53,503 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:32:53,503 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:32:53,503 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:32:53,503 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:32:53,503 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:32:53,568 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:32:54,534 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:32:54,545 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:32:54,841 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:32:54,842 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:32:54,842 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:32:55,292 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:32:55,294 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:32:55,826 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:32:55,826 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:32:55,827 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:32:55,828 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:32:55,829 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:32:55,830 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:32:55,830 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:32:55,830 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:32:55,839 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:32:59,666 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:32:59,666 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:32:59,754 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:32:59,896 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:32:59,902 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:32:59,907 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:32:59,912 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:33:02,942 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-18 16:33:08,262 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:33:08,262 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:39:55,523 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 990, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 112, in run
    self.on_advance_end()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 177, in on_advance_end
    self._run_validation()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 257, in _run_validation
    self.val_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 94, in advance
    batch_idx, batch = next(dataloader_iter)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1186, in _next_data
    idx, data = self._get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1142, in _get_data
    success, data = self._try_get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1003, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 5201, 5203, 5205, 5207, 5208, 5210, 5212, 5214, 5216, 5218, 5220, 5222, 5223, 5225, 5227, 5229, 5234, 5236, 5238, 5240, 5242, 5244, 5246, 5248, 5250) exited unexpectedly

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1062, in _run_train
    self.training_type_plugin.reconciliate_processes(traceback.format_exc())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 476, in reconciliate_processes
    os.kill(pid, signal.SIGKILL)
ProcessLookupError: [Errno 3] No such process
[2022-01-18 16:40:14,367 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:40:15,265 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:40:15,278 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:40:15,594 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:40:15,595 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:40:15,595 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:40:15,687 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:40:15,687 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:40:15,687 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:40:15,687 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:40:15,687 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:40:15,748 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:40:16,770 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:40:16,785 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:40:17,121 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:40:17,122 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:40:17,123 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:40:17,211 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:40:17,212 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:40:17,212 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:40:17,213 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:40:17,469 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:40:17,471 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:40:18,214 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:40:18,222 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:40:18,222 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:40:18,223 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:40:18,225 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:40:22,229 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:40:22,230 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:40:22,230 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 873, in _run
    self.accelerator.setup(self, model)  # note: this sets up self.lightning_module
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/gpu.py", line 42, in setup
    return super().setup(trainer, model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 88, in setup
    self.setup_optimizers(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 330, in setup_optimizers
    optimizers, lr_schedulers, optimizer_frequencies = self.training_type_plugin.init_optimizers(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 223, in init_optimizers
    return trainer.init_optimizers(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/optimizers.py", line 34, in init_optimizers
    optim_conf = model.configure_optimizers()
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 323, in configure_optimizers
    optimizer = torch.optim.Adam(self.net.parameters(), lr=self.hparams.lr,
TypeError: __init__() got an unexpected keyword argument 'momentum'
[2022-01-18 16:40:22,230 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 873, in _run
    self.accelerator.setup(self, model)  # note: this sets up self.lightning_module
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/gpu.py", line 42, in setup
    return super().setup(trainer, model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 88, in setup
    self.setup_optimizers(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 330, in setup_optimizers
    optimizers, lr_schedulers, optimizer_frequencies = self.training_type_plugin.init_optimizers(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 223, in init_optimizers
    return trainer.init_optimizers(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/optimizers.py", line 34, in init_optimizers
    optim_conf = model.configure_optimizers()
  File "/home/doni-lab-ai/Documenti/NeuralNetworks/src/mobilenetv3.py", line 323, in configure_optimizers
    optimizer = torch.optim.Adam(self.net.parameters(), lr=self.hparams.lr,
TypeError: __init__() got an unexpected keyword argument 'momentum'
[2022-01-18 16:41:06,946 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:41:07,865 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:41:07,875 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:41:08,172 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:41:08,173 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:41:08,173 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:41:08,259 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:41:08,259 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:41:08,259 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:41:08,259 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:41:08,259 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:41:08,322 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:41:09,269 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:41:09,281 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:41:09,605 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:41:09,606 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:41:09,606 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:41:09,698 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:41:09,699 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:41:09,699 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:41:09,700 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:41:10,041 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:41:10,045 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:41:10,702 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:41:10,702 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:41:10,702 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:41:10,703 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:41:10,703 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:41:14,647 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:41:14,647 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:41:14,718 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:41:14,878 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:41:14,884 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:41:14,893 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:41:14,899 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:41:18,065 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.141    Total estimated model params size (MB)
[2022-01-18 16:41:21,226 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:41:21,226 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:48:12,167 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:48:13,111 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:48:13,122 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:48:13,423 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:48:13,424 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:48:13,424 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:48:13,492 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-18 16:48:13,492 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-18 16:48:13,492 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-18 16:48:13,492 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:48:13,492 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:48:13,551 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-18 16:48:14,514 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:48:14,524 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:48:14,833 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-18 16:48:14,834 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:48:14,834 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-18 16:48:14,902 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-18 16:48:14,902 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-18 16:48:14,903 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:48:14,904 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-18 16:48:15,273 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:48:15,277 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-18 16:48:15,905 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-18 16:48:15,915 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-18 16:48:15,915 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-18 16:48:15,915 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-18 16:48:15,916 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-18 16:48:20,083 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:48:20,084 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-18 16:48:20,153 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetworks, universal_newlines=False, shell=None, istream=None)
[2022-01-18 16:48:20,300 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:48:20,308 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-18 16:48:20,316 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 16:48:20,322 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-18 16:48:23,492 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.085     Total estimated model params size (MB)
[2022-01-18 16:48:26,680 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 16:48:26,680 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-18 17:11:54,736 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-18 17:11:54,745 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-18 17:11:54,780 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  1421.3         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  28.149         	|50             	|  1407.5         	|  99.03          	|
run_training_batch                 	|  0.16201        	|5900           	|  955.86         	|  67.255         	|
model_forward                      	|  0.1563         	|5900           	|  922.17         	|  64.884         	|
training_step                      	|  0.1562         	|5900           	|  921.58         	|  64.843         	|
closure_0                          	|  0.11165        	|5900           	|  658.76         	|  46.351         	|
get_train_batch                    	|  0.033206       	|5900           	|  195.92         	|  13.785         	|
training_batch_to_device           	|  0.0086344      	|5900           	|  50.943         	|  3.5843         	|
evaluation_step_and_end            	|  0.041977       	|1002           	|  42.061         	|  2.9594         	|
validation_step                    	|  0.041892       	|1002           	|  41.975         	|  2.9534         	|
evaluation_batch_to_device         	|  0.0084748      	|1002           	|  8.4917         	|  0.59748        	|
on_train_batch_end                 	|  0.00020896     	|5900           	|  1.2329         	|  0.086746       	|
on_train_epoch_end                 	|  0.0070569      	|50             	|  0.35284        	|  0.024826       	|
on_after_backward                  	|  4.3482e-05     	|5900           	|  0.25655        	|  0.018051       	|
on_before_optimizer_step           	|  3.1957e-05     	|5900           	|  0.18854        	|  0.013266       	|
on_validation_batch_end            	|  0.00018263     	|1002           	|  0.18299        	|  0.012875       	|
on_before_backward                 	|  2.8283e-05     	|5900           	|  0.16687        	|  0.011741       	|
on_batch_start                     	|  2.7738e-05     	|5900           	|  0.16366        	|  0.011515       	|
on_train_batch_start               	|  2.3316e-05     	|5900           	|  0.13756        	|  0.009679       	|
training_step_end                  	|  2.0878e-05     	|5900           	|  0.12318        	|  0.0086669      	|
on_batch_end                       	|  1.9406e-05     	|5900           	|  0.1145         	|  0.0080559      	|
on_validation_end                  	|  0.0016235      	|51             	|  0.082799       	|  0.0058258      	|
on_validation_start                	|  0.00068269     	|51             	|  0.034817       	|  0.0024497      	|
on_validation_batch_start          	|  3.0743e-05     	|1002           	|  0.030804       	|  0.0021674      	|
on_train_epoch_start               	|  0.00059281     	|50             	|  0.02964        	|  0.0020855      	|
validation_step_end                	|  1.6223e-05     	|1002           	|  0.016255       	|  0.0011437      	|
on_epoch_end                       	|  3.372e-05      	|101            	|  0.0034057      	|  0.00023963     	|
on_train_start                     	|  0.0030774      	|1              	|  0.0030774      	|  0.00021652     	|
on_validation_epoch_end            	|  5.1857e-05     	|51             	|  0.0026447      	|  0.00018608     	|
on_epoch_start                     	|  2.4314e-05     	|101            	|  0.0024557      	|  0.00017278     	|
on_validation_epoch_start          	|  2.03e-05       	|51             	|  0.0010353      	|  7.2845e-05     	|
on_train_end                       	|  0.00038594     	|1              	|  0.00038594     	|  2.7155e-05     	|
on_fit_start                       	|  4.7937e-05     	|1              	|  4.7937e-05     	|  3.3729e-06     	|
on_val_dataloader                  	|  2.1709e-05     	|1              	|  2.1709e-05     	|  1.5275e-06     	|
on_train_dataloader                	|  1.9031e-05     	|1              	|  1.9031e-05     	|  1.339e-06      	|
on_before_accelerator_backend_setup	|  8.3498e-06     	|1              	|  8.3498e-06     	|  5.8749e-07     	|

[2022-01-20 13:07:02,503 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 13:07:02,506 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/main.py", line 21, in run
    mod = importlib.import_module(mod_name)
  File "/home/doni-lab-ai/miniconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 855, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 3, in <module>
    import torch
ModuleNotFoundError: No module named 'torch'
[2022-01-20 13:07:11,996 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 13:07:14,002 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:07:14,016 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:07:14,548 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 13:07:14,549 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 13:07:14,550 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 13:07:14,657 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 13:07:14,657 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 13:07:14,657 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 13:07:14,657 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 13:07:14,657 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 13:07:14,720 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 13:07:15,662 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:07:15,671 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:07:15,971 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 13:07:15,972 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 13:07:15,972 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 13:07:16,036 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 13:07:16,036 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 13:07:16,037 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 13:07:16,038 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 13:07:16,437 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 13:07:16,441 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 13:07:17,041 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 13:07:17,047 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 13:07:17,048 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 13:07:17,048 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 13:07:17,052 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 13:07:22,245 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 13:07:22,246 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 13:07:22,341 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:07:22,484 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 13:07:22,492 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 13:07:22,500 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 13:07:22,506 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 13:07:25,907 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.085     Total estimated model params size (MB)
[2022-01-20 13:07:28,881 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 13:07:28,881 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 13:32:05,462 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  1490.8         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  29.519         	|50             	|  1475.9         	|  99.005         	|
run_training_batch                 	|  0.16811        	|5900           	|  991.87         	|  66.534         	|
model_forward                      	|  0.16157        	|5900           	|  953.24         	|  63.943         	|
training_step                      	|  0.16145        	|5900           	|  952.58         	|  63.898         	|
get_train_batch                    	|  0.03675        	|5900           	|  216.82         	|  14.544         	|
training_batch_to_device           	|  0.010724       	|5900           	|  63.269         	|  4.2441         	|
evaluation_step_and_end            	|  0.047642       	|1002           	|  47.737         	|  3.2022         	|
validation_step                    	|  0.04753        	|1002           	|  47.625         	|  3.1947         	|
closure_0                          	|  0.0077133      	|5900           	|  45.508         	|  3.0527         	|
evaluation_batch_to_device         	|  0.010461       	|1002           	|  10.482         	|  0.7031         	|
on_train_batch_end                 	|  0.00023507     	|5900           	|  1.3869         	|  0.093032       	|
on_after_backward                  	|  5.8758e-05     	|5900           	|  0.34667        	|  0.023254       	|
on_train_epoch_end                 	|  0.0066704      	|50             	|  0.33352        	|  0.022372       	|
on_validation_batch_end            	|  0.000243       	|1002           	|  0.24348        	|  0.016333       	|
on_before_optimizer_step           	|  3.6177e-05     	|5900           	|  0.21344        	|  0.014318       	|
on_before_backward                 	|  3.4968e-05     	|5900           	|  0.20631        	|  0.013839       	|
on_batch_start                     	|  3.3035e-05     	|5900           	|  0.1949         	|  0.013074       	|
on_train_batch_start               	|  3.0099e-05     	|5900           	|  0.17758        	|  0.011912       	|
on_batch_end                       	|  2.2626e-05     	|5900           	|  0.13349        	|  0.0089545      	|
training_step_end                  	|  1.9859e-05     	|5900           	|  0.11717        	|  0.0078596      	|
on_validation_end                  	|  0.0019888      	|51             	|  0.10143        	|  0.0068039      	|
on_train_epoch_start               	|  0.00079129     	|50             	|  0.039564       	|  0.002654       	|
on_validation_start                	|  0.0007636      	|51             	|  0.038944       	|  0.0026123      	|
on_validation_batch_start          	|  3.73e-05       	|1002           	|  0.037374       	|  0.002507       	|
validation_step_end                	|  2.0752e-05     	|1002           	|  0.020794       	|  0.0013948      	|
on_epoch_end                       	|  3.8557e-05     	|101            	|  0.0038942      	|  0.00026122     	|
on_epoch_start                     	|  2.9776e-05     	|101            	|  0.0030074      	|  0.00020173     	|
on_validation_epoch_end            	|  5.8116e-05     	|51             	|  0.0029639      	|  0.00019882     	|
on_train_start                     	|  0.0021067      	|1              	|  0.0021067      	|  0.00014132     	|
on_validation_epoch_start          	|  2.3026e-05     	|51             	|  0.0011743      	|  7.8772e-05     	|
on_train_end                       	|  0.00062748     	|1              	|  0.00062748     	|  4.2091e-05     	|
on_fit_start                       	|  0.00013631     	|1              	|  0.00013631     	|  9.1436e-06     	|
on_val_dataloader                  	|  3.4784e-05     	|1              	|  3.4784e-05     	|  2.3333e-06     	|
on_train_dataloader                	|  1.9797e-05     	|1              	|  1.9797e-05     	|  1.328e-06      	|
on_before_accelerator_backend_setup	|  9.269e-06      	|1              	|  9.269e-06      	|  6.2176e-07     	|

[2022-01-20 13:35:02,305 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 13:35:03,279 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:35:03,286 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:35:03,576 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/_utils_internal.py", line 55, in get_source_lines_and_file
    sourcelines, file_lineno = inspect.getsourcelines(obj)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/inspect.py", line 967, in getsourcelines
    lines, lnum = findsource(object)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/inspect.py", line 798, in findsource
    raise OSError('could not get source code')
OSError: could not get source code

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "main.py", line 21, in run
    mod = importlib.import_module(mod_name)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 15, in <module>
    from src.mobilenetv3 import MobileNetV3Module
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 21, in <module>
    class BNeckSpecification:
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/jit/_script.py", line 1128, in script
    _compile_and_register_class(obj, _rcb, qualified_name)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/jit/_script.py", line 136, in _compile_and_register_class
    ast = get_jit_class_def(obj, obj.__name__)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/jit/frontend.py", line 198, in get_jit_class_def
    methods = [get_jit_def(obj,
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/jit/frontend.py", line 198, in <listcomp>
    methods = [get_jit_def(obj,
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/jit/frontend.py", line 269, in get_jit_def
    sourcelines, file_lineno, filename = get_source_lines_and_file(fn, torch._C.ErrorReport.call_stack())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/_utils_internal.py", line 62, in get_source_lines_and_file
    raise OSError(msg) from e
OSError: Can't get source for <function __eq__ at 0x7f10ee9e35e0>. TorchScript requires source access in order to carry out compilation, make sure original .py files are available.
[2022-01-20 13:37:16,193 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 13:37:17,196 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:37:17,204 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 13:37:17,516 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 21, in run
    mod = importlib.import_module(mod_name)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 15, in <module>
    from src.mobilenetv3 import MobileNetV3Module
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 21, in <module>
    class BNeckSpecification:
TypeError: trace() missing 1 required positional argument: 'example_inputs'
[2022-01-20 15:14:21,959 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:14:23,358 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:14:23,370 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:14:23,894 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:14:23,895 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:14:23,895 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:14:23,966 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 15:14:23,966 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 15:14:23,966 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 15:14:23,966 INFO @src.logger.base_logger] 154 - Precision: 32
[2022-01-20 15:14:23,966 INFO @src.logger.base_logger] 155 - Train the mobilenetv3 model.
[2022-01-20 15:14:24,028 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:14:24,969 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:14:24,983 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:14:25,380 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:14:25,382 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:14:25,382 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:14:25,455 INFO @src.logger.base_logger] 154 - Precision: 32
[2022-01-20 15:14:25,455 INFO @src.logger.base_logger] 155 - Train the mobilenetv3 model.
[2022-01-20 15:14:25,456 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:14:25,457 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 15:14:25,749 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:14:25,752 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 15:14:26,459 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 15:14:26,463 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 15:14:26,463 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 15:14:26,463 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 15:14:26,470 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 15:14:30,728 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:14:30,728 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:14:30,787 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:14:30,908 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:14:30,917 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 15:14:30,924 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:14:30,933 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 15:14:34,491 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-20 15:14:36,968 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 159, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1035, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1122, in _run_sanity_check
    self._evaluation_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 111, in advance
    output = self.evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 158, in evaluation_step
    output = self.trainer.accelerator.validation_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 211, in validation_step
    return self.training_type_plugin.validation_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 392, in validation_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 93, in forward
    output = self.module.validation_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 285, in validation_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 250, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 3, 3, 3], expected input[256, 1, 224, 224] to have 3 channels, but got 1 channels instead
[2022-01-20 15:14:37,234 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 159, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1035, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1122, in _run_sanity_check
    self._evaluation_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 111, in advance
    output = self.evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 158, in evaluation_step
    output = self.trainer.accelerator.validation_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 211, in validation_step
    return self.training_type_plugin.validation_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 392, in validation_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 93, in forward
    output = self.module.validation_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 285, in validation_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 250, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 3, 3, 3], expected input[256, 1, 224, 224] to have 3 channels, but got 1 channels instead
[2022-01-20 15:18:20,955 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:18:21,904 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:18:21,919 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:18:22,313 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:18:22,314 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:18:22,314 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:18:23,951 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 15:18:23,951 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 15:18:23,952 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 15:18:23,952 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:18:23,952 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:18:24,022 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:18:24,979 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:18:24,993 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:18:25,344 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:18:25,345 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:18:25,345 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:18:25,744 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:18:25,747 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 15:18:26,718 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:18:26,718 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:18:26,718 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:18:26,719 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 15:18:26,720 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 15:18:26,727 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 15:18:26,727 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 15:18:26,727 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 15:18:26,730 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 15:18:31,023 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:18:31,023 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:18:31,091 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:18:31,213 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:18:31,220 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 15:18:31,226 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:18:31,233 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 15:18:34,541 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-20 15:18:40,555 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:18:40,555 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:21:12,772 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:21:12,781 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-20 15:21:12,794 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  168.84         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  30.435         	|5              	|  152.18         	|  90.133         	|
run_training_batch                 	|  0.20964        	|490            	|  102.72         	|  60.842         	|
model_forward                      	|  0.18796        	|490            	|  92.102         	|  54.551         	|
training_step                      	|  0.18784        	|490            	|  92.043         	|  54.516         	|
get_train_batch                    	|  0.051018       	|490            	|  24.999         	|  14.807         	|
closure_0                          	|  0.011533       	|490            	|  5.6511         	|  3.3471         	|
evaluation_step_and_end            	|  0.051558       	|102            	|  5.2589         	|  3.1148         	|
validation_step                    	|  0.05144        	|102            	|  5.2468         	|  3.1077         	|
training_batch_to_device           	|  0.00033988     	|490            	|  0.16654        	|  0.09864        	|
on_train_batch_end                 	|  0.00030301     	|490            	|  0.14848        	|  0.087941       	|
on_train_epoch_end                 	|  0.024489       	|5              	|  0.12244        	|  0.072522       	|
evaluation_batch_to_device         	|  0.0008981      	|102            	|  0.091606       	|  0.054257       	|
on_after_backward                  	|  6.2352e-05     	|490            	|  0.030552       	|  0.018096       	|
on_validation_batch_end            	|  0.00022774     	|102            	|  0.02323        	|  0.013759       	|
on_before_optimizer_step           	|  3.8715e-05     	|490            	|  0.018971       	|  0.011236       	|
on_before_backward                 	|  3.7429e-05     	|490            	|  0.01834        	|  0.010863       	|
on_batch_start                     	|  2.7752e-05     	|490            	|  0.013598       	|  0.0080543      	|
on_train_batch_start               	|  2.5304e-05     	|490            	|  0.012399       	|  0.0073437      	|
on_batch_end                       	|  2.2268e-05     	|490            	|  0.010911       	|  0.0064626      	|
training_step_end                  	|  2.2091e-05     	|490            	|  0.010825       	|  0.0064114      	|
on_validation_end                  	|  0.001148       	|6              	|  0.0068879      	|  0.0040797      	|
on_validation_batch_start          	|  5.0827e-05     	|102            	|  0.0051844      	|  0.0030707      	|
on_validation_start                	|  0.00066514     	|6              	|  0.0039908      	|  0.0023637      	|
on_train_start                     	|  0.0031825      	|1              	|  0.0031825      	|  0.001885       	|
on_train_epoch_start               	|  0.00051834     	|5              	|  0.0025917      	|  0.001535       	|
validation_step_end                	|  2.4354e-05     	|102            	|  0.0024841      	|  0.0014713      	|
on_train_end                       	|  0.00041513     	|1              	|  0.00041513     	|  0.00024588     	|
on_validation_epoch_end            	|  5.4666e-05     	|6              	|  0.00032799     	|  0.00019427     	|
on_epoch_end                       	|  2.6118e-05     	|11             	|  0.0002873      	|  0.00017017     	|
on_epoch_start                     	|  2.3899e-05     	|11             	|  0.00026289     	|  0.00015571     	|
on_validation_epoch_start          	|  2.2844e-05     	|6              	|  0.00013706     	|  8.1181e-05     	|
on_fit_start                       	|  0.00011328     	|1              	|  0.00011328     	|  6.7094e-05     	|
on_val_dataloader                  	|  3.8309e-05     	|1              	|  3.8309e-05     	|  2.269e-05      	|
on_train_dataloader                	|  2.8085e-05     	|1              	|  2.8085e-05     	|  1.6634e-05     	|
on_before_accelerator_backend_setup	|  1.1601e-05     	|1              	|  1.1601e-05     	|  6.8712e-06     	|

[2022-01-20 15:25:02,764 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:25:03,719 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:25:03,729 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:25:04,055 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:25:04,056 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:25:04,057 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:25:05,078 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 15:25:05,079 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 15:25:05,079 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 15:25:05,079 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:25:05,079 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:25:05,148 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:25:06,128 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:25:06,138 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:25:06,449 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:25:06,450 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:25:06,450 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:25:06,868 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:25:06,871 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 15:25:07,666 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:25:07,666 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:25:07,667 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:25:07,667 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 15:25:07,668 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 15:25:07,674 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 15:25:07,675 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 15:25:07,675 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 15:25:07,679 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 15:25:12,018 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:25:12,018 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:25:12,089 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:25:12,218 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:25:12,225 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 15:25:12,234 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:25:12,240 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 15:25:15,485 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-20 15:25:20,862 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:25:20,865 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:33:36,215 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:33:37,177 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:33:37,187 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:33:37,520 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:33:37,521 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:33:37,521 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:33:38,516 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 149, in run
    model = MobileNetV3Module(hparams, rgb_img, mode=args.mode)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 234, in __init__
    self.net = MobileNetV3(self.hparams.num_classes, self.hparams.dropout, self.rgb_img, self.mode)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 161, in __init__
    self.bneck_specs = self.load_bneck_specs()
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 195, in load_bneck_specs
    bneck_specs = [BNeckSpecification(*spec.values()) for spec in data]
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 195, in <listcomp>
    bneck_specs = [BNeckSpecification(*spec.values()) for spec in data]
TypeError: __init__() missing 1 required positional argument: 'stride'
[2022-01-20 15:36:32,907 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:36:33,830 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:36:33,839 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:36:34,156 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:36:34,157 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:36:34,157 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:36:35,248 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 15:36:35,248 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 15:36:35,248 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 15:36:35,248 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:36:35,248 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:36:35,315 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:36:36,284 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:36:36,293 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:36:36,595 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:36:36,596 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:36:36,596 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:36:37,036 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:36:37,039 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 15:36:37,698 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:36:37,698 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:36:37,699 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:36:37,699 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 15:36:37,700 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 15:36:37,708 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 15:36:37,708 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 15:36:37,708 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 15:36:37,710 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 15:36:42,358 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:36:42,360 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:36:42,455 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:36:42,596 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:36:42,603 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 15:36:42,608 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:36:42,614 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 15:36:45,971 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-20 15:36:51,723 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:36:51,726 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:37:01,190 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 54, in forward
    return F.relu6(x + 3, inplace=self.inplace) / 6
RuntimeError: CUDA out of memory. Tried to allocate 46.00 MiB (GPU 0; 23.65 GiB total capacity; 14.43 GiB already allocated; 9.94 MiB free; 15.05 GiB reserved in total by PyTorch)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1062, in _run_train
    self.training_type_plugin.reconciliate_processes(traceback.format_exc())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 478, in reconciliate_processes
    raise DeadlockDetectedException(f"DeadLock detected from rank: {self.global_rank} \n {trace}")
pytorch_lightning.utilities.exceptions.DeadlockDetectedException: DeadLock detected from rank: 0 
 Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 54, in forward
    return F.relu6(x + 3, inplace=self.inplace) / 6
RuntimeError: CUDA out of memory. Tried to allocate 46.00 MiB (GPU 0; 23.65 GiB total capacity; 14.43 GiB already allocated; 9.94 MiB free; 15.05 GiB reserved in total by PyTorch)

[2022-01-20 15:37:46,269 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:37:47,210 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:37:47,220 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:37:47,589 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:37:47,590 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:37:47,591 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:37:48,559 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 15:37:48,560 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 15:37:48,560 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 15:37:48,560 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:37:48,560 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:37:48,628 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 15:37:49,568 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:37:49,578 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:37:49,866 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 15:37:49,867 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:37:49,867 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 15:37:50,345 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:37:50,348 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 15:37:50,876 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 15:37:50,876 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 15:37:50,877 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:37:50,878 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 15:37:50,879 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 15:37:50,883 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 15:37:50,884 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 15:37:50,884 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 15:37:50,889 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 15:37:54,808 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:37:54,808 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 15:37:54,886 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 15:37:55,043 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:37:55,050 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 15:37:55,059 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:37:55,065 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 15:37:58,278 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-20 15:38:02,986 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:38:02,989 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 15:54:58,475 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 15:54:58,483 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-20 15:54:58,506 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  1029.9         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  50.769         	|20             	|  1015.4         	|  98.588         	|
run_training_batch                 	|  0.20786        	|3920           	|  814.8          	|  79.112         	|
model_forward                      	|  0.19538        	|3920           	|  765.89         	|  74.363         	|
training_step                      	|  0.19527        	|3920           	|  765.46         	|  74.322         	|
closure_0                          	|  0.031679       	|3920           	|  124.18         	|  12.058         	|
get_train_batch                    	|  0.01921        	|3920           	|  75.304         	|  7.3116         	|
evaluation_step_and_end            	|  0.0556         	|802            	|  44.591         	|  4.3295         	|
validation_step                    	|  0.055493       	|802            	|  44.505         	|  4.3212         	|
training_batch_to_device           	|  0.00028932     	|3920           	|  1.1341         	|  0.11012        	|
on_train_batch_end                 	|  0.00025311     	|3920           	|  0.99218        	|  0.096335       	|
on_train_epoch_end                 	|  0.014352       	|20             	|  0.28704        	|  0.02787        	|
on_after_backward                  	|  6.2605e-05     	|3920           	|  0.24541        	|  0.023828       	|
on_validation_batch_end            	|  0.00022116     	|802            	|  0.17737        	|  0.017222       	|
on_before_optimizer_step           	|  4.5036e-05     	|3920           	|  0.17654        	|  0.017141       	|
evaluation_batch_to_device         	|  0.00021737     	|802            	|  0.17433        	|  0.016927       	|
on_before_backward                 	|  3.5526e-05     	|3920           	|  0.13926        	|  0.013522       	|
on_batch_start                     	|  2.5605e-05     	|3920           	|  0.10037        	|  0.0097455      	|
on_train_batch_start               	|  2.411e-05      	|3920           	|  0.094512       	|  0.0091766      	|
on_batch_end                       	|  2.2305e-05     	|3920           	|  0.087437       	|  0.0084896      	|
training_step_end                  	|  1.9898e-05     	|3920           	|  0.078001       	|  0.0075734      	|
on_validation_end                  	|  0.0019215      	|21             	|  0.040351       	|  0.0039179      	|
on_validation_batch_start          	|  3.4371e-05     	|802            	|  0.027566       	|  0.0026765      	|
validation_step_end                	|  2.1756e-05     	|802            	|  0.017448       	|  0.0016941      	|
on_validation_start                	|  0.00082313     	|21             	|  0.017286       	|  0.0016783      	|
on_train_epoch_start               	|  0.00076105     	|20             	|  0.015221       	|  0.0014779      	|
on_train_start                     	|  0.001888       	|1              	|  0.001888       	|  0.00018331     	|
on_epoch_end                       	|  3.2165e-05     	|41             	|  0.0013187      	|  0.00012804     	|
on_validation_epoch_end            	|  5.6175e-05     	|21             	|  0.0011797      	|  0.00011454     	|
on_epoch_start                     	|  2.8586e-05     	|41             	|  0.001172       	|  0.0001138      	|
on_validation_epoch_start          	|  2.4098e-05     	|21             	|  0.00050605     	|  4.9135e-05     	|
on_train_end                       	|  0.00046349     	|1              	|  0.00046349     	|  4.5002e-05     	|
on_fit_start                       	|  4.5743e-05     	|1              	|  4.5743e-05     	|  4.4414e-06     	|
on_val_dataloader                  	|  3.5277e-05     	|1              	|  3.5277e-05     	|  3.4252e-06     	|
on_train_dataloader                	|  1.9463e-05     	|1              	|  1.9463e-05     	|  1.8897e-06     	|
on_before_accelerator_backend_setup	|  8.6389e-06     	|1              	|  8.6389e-06     	|  8.3879e-07     	|

[2022-01-20 16:06:31,162 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 16:06:32,058 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:06:32,070 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:06:32,421 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 16:06:32,422 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 16:06:32,423 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 16:06:56,860 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:06:57,785 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:06:57,797 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:06:59,079 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 68, in run
    model = MobileNetV3Module.load_from_checkpoint(checkpoint_path="../checkpoints/"+checkpoint_name)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 131, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 32, in load
    with fs.open(path_or_url, "rb") as f:
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/spec.py", line 1006, in open
    f = self._open(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/implementations/local.py", line 155, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/implementations/local.py", line 250, in __init__
    self._open()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/implementations/local.py", line 255, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/home/doni-lab-ai/Documenti/NeuralNetwork-project/../checkpoints/mobilenetv3-small-cifar10.ckpt'
[2022-01-20 16:07:10,320 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:07:11,275 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:07:11,286 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:07:12,593 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 68, in run
    model = MobileNetV3Module.load_from_checkpoint(checkpoint_path="./checkpoints/"+checkpoint_name)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 153, in load_from_checkpoint
    model = cls._load_model_state(checkpoint, strict=strict, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 195, in _load_model_state
    model = cls(**_cls_kwargs)
TypeError: __init__() missing 1 required positional argument: 'rgb_img'
[2022-01-20 16:08:05,957 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:08:06,859 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:06,869 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:08,202 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 68, in run
    model = MobileNetV3Module.load_from_checkpoint(checkpoint_path="./checkpoints/"+checkpoint_name, rgb_img=rgb_img, )
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 153, in load_from_checkpoint
    model = cls._load_model_state(checkpoint, strict=strict, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 201, in _load_model_state
    keys = model.load_state_dict(checkpoint["state_dict"], strict=strict)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1406, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for MobileNetV3Module:
	Missing key(s) in state_dict: "net.net_blocks.12.0.weight", "net.net_blocks.12.1.weight", "net.net_blocks.12.1.bias", "net.net_blocks.12.1.running_mean", "net.net_blocks.12.1.running_var", "net.net_blocks.14.weight", "net.net_blocks.14.bias". 
	Unexpected key(s) in state_dict: "net.net_blocks.16.0.weight", "net.net_blocks.16.1.weight", "net.net_blocks.16.1.bias", "net.net_blocks.16.1.running_mean", "net.net_blocks.16.1.running_var", "net.net_blocks.16.1.num_batches_tracked", "net.net_blocks.18.weight", "net.net_blocks.18.bias", "net.net_blocks.12.conv2d_pw.weight", "net.net_blocks.12.batch_norm.weight", "net.net_blocks.12.batch_norm.bias", "net.net_blocks.12.batch_norm.running_mean", "net.net_blocks.12.batch_norm.running_var", "net.net_blocks.12.batch_norm.num_batches_tracked", "net.net_blocks.12.conv2d_dw.weight", "net.net_blocks.12.squeeze_ex.se.0.weight", "net.net_blocks.12.squeeze_ex.se.2.weight", "net.net_blocks.12.conv2d_pw_linear.weight", "net.net_blocks.12.batch_norm_linear.weight", "net.net_blocks.12.batch_norm_linear.bias", "net.net_blocks.12.batch_norm_linear.running_mean", "net.net_blocks.12.batch_norm_linear.running_var", "net.net_blocks.12.batch_norm_linear.num_batches_tracked", "net.net_blocks.13.conv2d_pw.weight", "net.net_blocks.13.batch_norm.weight", "net.net_blocks.13.batch_norm.bias", "net.net_blocks.13.batch_norm.running_mean", "net.net_blocks.13.batch_norm.running_var", "net.net_blocks.13.batch_norm.num_batches_tracked", "net.net_blocks.13.conv2d_dw.weight", "net.net_blocks.13.squeeze_ex.se.0.weight", "net.net_blocks.13.squeeze_ex.se.2.weight", "net.net_blocks.13.conv2d_pw_linear.weight", "net.net_blocks.13.batch_norm_linear.weight", "net.net_blocks.13.batch_norm_linear.bias", "net.net_blocks.13.batch_norm_linear.running_mean", "net.net_blocks.13.batch_norm_linear.running_var", "net.net_blocks.13.batch_norm_linear.num_batches_tracked", "net.net_blocks.14.conv2d_pw.weight", "net.net_blocks.14.batch_norm.weight", "net.net_blocks.14.batch_norm.bias", "net.net_blocks.14.batch_norm.running_mean", "net.net_blocks.14.batch_norm.running_var", "net.net_blocks.14.batch_norm.num_batches_tracked", "net.net_blocks.14.conv2d_dw.weight", "net.net_blocks.14.squeeze_ex.se.0.weight", "net.net_blocks.14.squeeze_ex.se.2.weight", "net.net_blocks.14.conv2d_pw_linear.weight", "net.net_blocks.14.batch_norm_linear.weight", "net.net_blocks.14.batch_norm_linear.bias", "net.net_blocks.14.batch_norm_linear.running_mean", "net.net_blocks.14.batch_norm_linear.running_var", "net.net_blocks.14.batch_norm_linear.num_batches_tracked", "net.net_blocks.15.conv2d_pw.weight", "net.net_blocks.15.batch_norm.weight", "net.net_blocks.15.batch_norm.bias", "net.net_blocks.15.batch_norm.running_mean", "net.net_blocks.15.batch_norm.running_var", "net.net_blocks.15.batch_norm.num_batches_tracked", "net.net_blocks.15.conv2d_dw.weight", "net.net_blocks.15.squeeze_ex.se.0.weight", "net.net_blocks.15.squeeze_ex.se.2.weight", "net.net_blocks.15.conv2d_pw_linear.weight", "net.net_blocks.15.batch_norm_linear.weight", "net.net_blocks.15.batch_norm_linear.bias", "net.net_blocks.15.batch_norm_linear.running_mean", "net.net_blocks.15.batch_norm_linear.running_var", "net.net_blocks.15.batch_norm_linear.num_batches_tracked". 
	size mismatch for net.net_blocks.2.conv2d_pw.weight: copying a param with shape torch.Size([64, 16, 1, 1]) from checkpoint, the shape in current model is torch.Size([72, 16, 1, 1]).
	size mismatch for net.net_blocks.2.batch_norm.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([72]).
	size mismatch for net.net_blocks.2.batch_norm.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([72]).
	size mismatch for net.net_blocks.2.batch_norm.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([72]).
	size mismatch for net.net_blocks.2.batch_norm.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([72]).
	size mismatch for net.net_blocks.2.conv2d_dw.weight: copying a param with shape torch.Size([64, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([72, 1, 3, 3]).
	size mismatch for net.net_blocks.2.squeeze_ex.se.0.weight: copying a param with shape torch.Size([16, 64]) from checkpoint, the shape in current model is torch.Size([18, 72]).
	size mismatch for net.net_blocks.2.squeeze_ex.se.2.weight: copying a param with shape torch.Size([64, 16]) from checkpoint, the shape in current model is torch.Size([72, 18]).
	size mismatch for net.net_blocks.2.conv2d_pw_linear.weight: copying a param with shape torch.Size([24, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([24, 72, 1, 1]).
	size mismatch for net.net_blocks.3.conv2d_pw.weight: copying a param with shape torch.Size([72, 24, 1, 1]) from checkpoint, the shape in current model is torch.Size([88, 24, 1, 1]).
	size mismatch for net.net_blocks.3.batch_norm.weight: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([88]).
	size mismatch for net.net_blocks.3.batch_norm.bias: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([88]).
	size mismatch for net.net_blocks.3.batch_norm.running_mean: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([88]).
	size mismatch for net.net_blocks.3.batch_norm.running_var: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([88]).
	size mismatch for net.net_blocks.3.conv2d_dw.weight: copying a param with shape torch.Size([72, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([88, 1, 3, 3]).
	size mismatch for net.net_blocks.3.squeeze_ex.se.0.weight: copying a param with shape torch.Size([18, 72]) from checkpoint, the shape in current model is torch.Size([22, 88]).
	size mismatch for net.net_blocks.3.squeeze_ex.se.2.weight: copying a param with shape torch.Size([72, 18]) from checkpoint, the shape in current model is torch.Size([88, 22]).
	size mismatch for net.net_blocks.3.conv2d_pw_linear.weight: copying a param with shape torch.Size([24, 72, 1, 1]) from checkpoint, the shape in current model is torch.Size([24, 88, 1, 1]).
	size mismatch for net.net_blocks.4.conv2d_pw.weight: copying a param with shape torch.Size([72, 24, 1, 1]) from checkpoint, the shape in current model is torch.Size([96, 24, 1, 1]).
	size mismatch for net.net_blocks.4.batch_norm.weight: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.4.batch_norm.bias: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.4.batch_norm.running_mean: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.4.batch_norm.running_var: copying a param with shape torch.Size([72]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.4.conv2d_dw.weight: copying a param with shape torch.Size([72, 1, 5, 5]) from checkpoint, the shape in current model is torch.Size([96, 1, 5, 5]).
	size mismatch for net.net_blocks.4.squeeze_ex.se.0.weight: copying a param with shape torch.Size([18, 72]) from checkpoint, the shape in current model is torch.Size([24, 96]).
	size mismatch for net.net_blocks.4.squeeze_ex.se.2.weight: copying a param with shape torch.Size([72, 18]) from checkpoint, the shape in current model is torch.Size([96, 24]).
	size mismatch for net.net_blocks.4.conv2d_pw_linear.weight: copying a param with shape torch.Size([40, 72, 1, 1]) from checkpoint, the shape in current model is torch.Size([40, 96, 1, 1]).
	size mismatch for net.net_blocks.5.conv2d_pw.weight: copying a param with shape torch.Size([120, 40, 1, 1]) from checkpoint, the shape in current model is torch.Size([240, 40, 1, 1]).
	size mismatch for net.net_blocks.5.batch_norm.weight: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.5.batch_norm.bias: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.5.batch_norm.running_mean: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.5.batch_norm.running_var: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.5.conv2d_dw.weight: copying a param with shape torch.Size([120, 1, 5, 5]) from checkpoint, the shape in current model is torch.Size([240, 1, 5, 5]).
	size mismatch for net.net_blocks.5.squeeze_ex.se.0.weight: copying a param with shape torch.Size([30, 120]) from checkpoint, the shape in current model is torch.Size([60, 240]).
	size mismatch for net.net_blocks.5.squeeze_ex.se.2.weight: copying a param with shape torch.Size([120, 30]) from checkpoint, the shape in current model is torch.Size([240, 60]).
	size mismatch for net.net_blocks.5.conv2d_pw_linear.weight: copying a param with shape torch.Size([40, 120, 1, 1]) from checkpoint, the shape in current model is torch.Size([40, 240, 1, 1]).
	size mismatch for net.net_blocks.6.conv2d_pw.weight: copying a param with shape torch.Size([120, 40, 1, 1]) from checkpoint, the shape in current model is torch.Size([240, 40, 1, 1]).
	size mismatch for net.net_blocks.6.batch_norm.weight: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.6.batch_norm.bias: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.6.batch_norm.running_mean: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.6.batch_norm.running_var: copying a param with shape torch.Size([120]) from checkpoint, the shape in current model is torch.Size([240]).
	size mismatch for net.net_blocks.6.conv2d_dw.weight: copying a param with shape torch.Size([120, 1, 5, 5]) from checkpoint, the shape in current model is torch.Size([240, 1, 5, 5]).
	size mismatch for net.net_blocks.6.squeeze_ex.se.0.weight: copying a param with shape torch.Size([30, 120]) from checkpoint, the shape in current model is torch.Size([60, 240]).
	size mismatch for net.net_blocks.6.squeeze_ex.se.2.weight: copying a param with shape torch.Size([120, 30]) from checkpoint, the shape in current model is torch.Size([240, 60]).
	size mismatch for net.net_blocks.6.conv2d_pw_linear.weight: copying a param with shape torch.Size([40, 120, 1, 1]) from checkpoint, the shape in current model is torch.Size([40, 240, 1, 1]).
	size mismatch for net.net_blocks.7.conv2d_pw.weight: copying a param with shape torch.Size([240, 40, 1, 1]) from checkpoint, the shape in current model is torch.Size([120, 40, 1, 1]).
	size mismatch for net.net_blocks.7.batch_norm.weight: copying a param with shape torch.Size([240]) from checkpoint, the shape in current model is torch.Size([120]).
	size mismatch for net.net_blocks.7.batch_norm.bias: copying a param with shape torch.Size([240]) from checkpoint, the shape in current model is torch.Size([120]).
	size mismatch for net.net_blocks.7.batch_norm.running_mean: copying a param with shape torch.Size([240]) from checkpoint, the shape in current model is torch.Size([120]).
	size mismatch for net.net_blocks.7.batch_norm.running_var: copying a param with shape torch.Size([240]) from checkpoint, the shape in current model is torch.Size([120]).
	size mismatch for net.net_blocks.7.conv2d_dw.weight: copying a param with shape torch.Size([240, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([120, 1, 5, 5]).
	size mismatch for net.net_blocks.7.squeeze_ex.se.0.weight: copying a param with shape torch.Size([60, 240]) from checkpoint, the shape in current model is torch.Size([30, 120]).
	size mismatch for net.net_blocks.7.squeeze_ex.se.2.weight: copying a param with shape torch.Size([240, 60]) from checkpoint, the shape in current model is torch.Size([120, 30]).
	size mismatch for net.net_blocks.7.conv2d_pw_linear.weight: copying a param with shape torch.Size([80, 240, 1, 1]) from checkpoint, the shape in current model is torch.Size([48, 120, 1, 1]).
	size mismatch for net.net_blocks.7.batch_norm_linear.weight: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.7.batch_norm_linear.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.7.batch_norm_linear.running_mean: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.7.batch_norm_linear.running_var: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.8.conv2d_pw.weight: copying a param with shape torch.Size([200, 80, 1, 1]) from checkpoint, the shape in current model is torch.Size([144, 48, 1, 1]).
	size mismatch for net.net_blocks.8.batch_norm.weight: copying a param with shape torch.Size([200]) from checkpoint, the shape in current model is torch.Size([144]).
	size mismatch for net.net_blocks.8.batch_norm.bias: copying a param with shape torch.Size([200]) from checkpoint, the shape in current model is torch.Size([144]).
	size mismatch for net.net_blocks.8.batch_norm.running_mean: copying a param with shape torch.Size([200]) from checkpoint, the shape in current model is torch.Size([144]).
	size mismatch for net.net_blocks.8.batch_norm.running_var: copying a param with shape torch.Size([200]) from checkpoint, the shape in current model is torch.Size([144]).
	size mismatch for net.net_blocks.8.conv2d_dw.weight: copying a param with shape torch.Size([200, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([144, 1, 5, 5]).
	size mismatch for net.net_blocks.8.squeeze_ex.se.0.weight: copying a param with shape torch.Size([50, 200]) from checkpoint, the shape in current model is torch.Size([36, 144]).
	size mismatch for net.net_blocks.8.squeeze_ex.se.2.weight: copying a param with shape torch.Size([200, 50]) from checkpoint, the shape in current model is torch.Size([144, 36]).
	size mismatch for net.net_blocks.8.conv2d_pw_linear.weight: copying a param with shape torch.Size([80, 200, 1, 1]) from checkpoint, the shape in current model is torch.Size([48, 144, 1, 1]).
	size mismatch for net.net_blocks.8.batch_norm_linear.weight: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.8.batch_norm_linear.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.8.batch_norm_linear.running_mean: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.8.batch_norm_linear.running_var: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([48]).
	size mismatch for net.net_blocks.9.conv2d_pw.weight: copying a param with shape torch.Size([184, 80, 1, 1]) from checkpoint, the shape in current model is torch.Size([288, 48, 1, 1]).
	size mismatch for net.net_blocks.9.batch_norm.weight: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([288]).
	size mismatch for net.net_blocks.9.batch_norm.bias: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([288]).
	size mismatch for net.net_blocks.9.batch_norm.running_mean: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([288]).
	size mismatch for net.net_blocks.9.batch_norm.running_var: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([288]).
	size mismatch for net.net_blocks.9.conv2d_dw.weight: copying a param with shape torch.Size([184, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([288, 1, 5, 5]).
	size mismatch for net.net_blocks.9.squeeze_ex.se.0.weight: copying a param with shape torch.Size([46, 184]) from checkpoint, the shape in current model is torch.Size([72, 288]).
	size mismatch for net.net_blocks.9.squeeze_ex.se.2.weight: copying a param with shape torch.Size([184, 46]) from checkpoint, the shape in current model is torch.Size([288, 72]).
	size mismatch for net.net_blocks.9.conv2d_pw_linear.weight: copying a param with shape torch.Size([80, 184, 1, 1]) from checkpoint, the shape in current model is torch.Size([96, 288, 1, 1]).
	size mismatch for net.net_blocks.9.batch_norm_linear.weight: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.9.batch_norm_linear.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.9.batch_norm_linear.running_mean: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.9.batch_norm_linear.running_var: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.10.conv2d_pw.weight: copying a param with shape torch.Size([184, 80, 1, 1]) from checkpoint, the shape in current model is torch.Size([576, 96, 1, 1]).
	size mismatch for net.net_blocks.10.batch_norm.weight: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.10.batch_norm.bias: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.10.batch_norm.running_mean: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.10.batch_norm.running_var: copying a param with shape torch.Size([184]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.10.conv2d_dw.weight: copying a param with shape torch.Size([184, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([576, 1, 5, 5]).
	size mismatch for net.net_blocks.10.squeeze_ex.se.0.weight: copying a param with shape torch.Size([46, 184]) from checkpoint, the shape in current model is torch.Size([144, 576]).
	size mismatch for net.net_blocks.10.squeeze_ex.se.2.weight: copying a param with shape torch.Size([184, 46]) from checkpoint, the shape in current model is torch.Size([576, 144]).
	size mismatch for net.net_blocks.10.conv2d_pw_linear.weight: copying a param with shape torch.Size([80, 184, 1, 1]) from checkpoint, the shape in current model is torch.Size([96, 576, 1, 1]).
	size mismatch for net.net_blocks.10.batch_norm_linear.weight: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.10.batch_norm_linear.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.10.batch_norm_linear.running_mean: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.10.batch_norm_linear.running_var: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.11.conv2d_pw.weight: copying a param with shape torch.Size([480, 80, 1, 1]) from checkpoint, the shape in current model is torch.Size([576, 96, 1, 1]).
	size mismatch for net.net_blocks.11.batch_norm.weight: copying a param with shape torch.Size([480]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.11.batch_norm.bias: copying a param with shape torch.Size([480]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.11.batch_norm.running_mean: copying a param with shape torch.Size([480]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.11.batch_norm.running_var: copying a param with shape torch.Size([480]) from checkpoint, the shape in current model is torch.Size([576]).
	size mismatch for net.net_blocks.11.conv2d_dw.weight: copying a param with shape torch.Size([480, 1, 3, 3]) from checkpoint, the shape in current model is torch.Size([576, 1, 5, 5]).
	size mismatch for net.net_blocks.11.squeeze_ex.se.0.weight: copying a param with shape torch.Size([120, 480]) from checkpoint, the shape in current model is torch.Size([144, 576]).
	size mismatch for net.net_blocks.11.squeeze_ex.se.2.weight: copying a param with shape torch.Size([480, 120]) from checkpoint, the shape in current model is torch.Size([576, 144]).
	size mismatch for net.net_blocks.11.conv2d_pw_linear.weight: copying a param with shape torch.Size([112, 480, 1, 1]) from checkpoint, the shape in current model is torch.Size([96, 576, 1, 1]).
	size mismatch for net.net_blocks.11.batch_norm_linear.weight: copying a param with shape torch.Size([112]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.11.batch_norm_linear.bias: copying a param with shape torch.Size([112]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.11.batch_norm_linear.running_mean: copying a param with shape torch.Size([112]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.net_blocks.11.batch_norm_linear.running_var: copying a param with shape torch.Size([112]) from checkpoint, the shape in current model is torch.Size([96]).
	size mismatch for net.classifier.1.weight: copying a param with shape torch.Size([10, 1280]) from checkpoint, the shape in current model is torch.Size([10, 1024]).
[2022-01-20 16:08:16,059 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:08:17,024 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:17,034 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:24,046 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 71, in run
    model(img)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Expected 4-dimensional input for 4-dimensional weight [16, 3, 3, 3], but got 1-dimensional input of size [128] instead
[2022-01-20 16:08:41,628 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:08:42,535 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:42,545 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:43,895 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 71, in run
    model(img)
NameError: name 'img' is not defined
[2022-01-20 16:08:54,116 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:08:55,020 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:55,030 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:08:56,379 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 71, in run
    model(valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
TypeError: conv2d() received an invalid combination of arguments - got (DataLoader, Parameter, NoneType, tuple, tuple, tuple, int), but expected one of:
 * (Tensor input, Tensor weight, Tensor bias, tuple of ints stride, tuple of ints padding, tuple of ints dilation, int groups)
      didn't match because some of the arguments have invalid types: ([31;1mDataLoader[0m, [31;1mParameter[0m, [31;1mNoneType[0m, [31;1mtuple[0m, [31;1mtuple[0m, [31;1mtuple[0m, [32;1mint[0m)
 * (Tensor input, Tensor weight, Tensor bias, tuple of ints stride, str padding, tuple of ints dilation, int groups)
      didn't match because some of the arguments have invalid types: ([31;1mDataLoader[0m, [31;1mParameter[0m, [31;1mNoneType[0m, [31;1mtuple[0m, [31;1mtuple[0m, [31;1mtuple[0m, [32;1mint[0m)

[2022-01-20 16:09:13,118 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:09:14,059 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:09:14,069 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:09:21,290 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 71, in run
    model(img)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 251, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
TypeError: conv2d() received an invalid combination of arguments - got (list, Parameter, NoneType, tuple, tuple, tuple, int), but expected one of:
 * (Tensor input, Tensor weight, Tensor bias, tuple of ints stride, tuple of ints padding, tuple of ints dilation, int groups)
      didn't match because some of the arguments have invalid types: ([31;1mlist[0m, [31;1mParameter[0m, [31;1mNoneType[0m, [31;1mtuple[0m, [31;1mtuple[0m, [31;1mtuple[0m, [32;1mint[0m)
 * (Tensor input, Tensor weight, Tensor bias, tuple of ints stride, str padding, tuple of ints dilation, int groups)
      didn't match because some of the arguments have invalid types: ([31;1mlist[0m, [31;1mParameter[0m, [31;1mNoneType[0m, [31;1mtuple[0m, [31;1mtuple[0m, [31;1mtuple[0m, [32;1mint[0m)

[2022-01-20 16:18:44,779 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:18:45,680 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:18:45,692 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:18:47,096 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 72, in run
    trainer = pl.Trainer(gpus=NUM_GPUS, accelerator=conf['trainer']['accelerator'],
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/env_vars_connector.py", line 40, in insert_env_defaults
    return fn(self, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'model'
[2022-01-20 16:19:36,843 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:19:37,769 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:19:37,779 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:19:39,125 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 16:19:39,125 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 16:19:39,125 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 16:19:39,189 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:19:40,086 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:19:40,096 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:19:40,913 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 16:19:41,411 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 16:19:41,412 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 16:19:41,417 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 16:19:41,418 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 16:19:41,418 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 16:19:41,424 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 16:19:45,120 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 16:19:45,120 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 16:19:45,166 WARNING @pytorch_lightning.loggers.tensorboard] 274 - Missing logger folder: /home/doni-lab-ai/Documenti/NeuralNetwork-project/lightning_logs
[2022-01-20 16:20:05,397 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:20:06,326 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:20:06,337 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:20:07,693 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 16:20:07,693 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 16:20:07,693 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 16:20:07,694 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[2022-01-20 16:20:07,695 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 16:20:07,695 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 1 nodes.
[2022-01-20 16:20:07,695 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 1 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 16:20:11,392 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 16:27:04,282 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:27:05,203 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:27:05,216 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:28:09,468 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:28:10,378 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:28:10,388 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:36:53,993 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:36:55,610 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:36:55,629 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:38:14,167 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:38:15,795 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:38:15,809 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:40:16,878 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:40:18,518 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:40:18,532 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:41:34,223 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:41:35,879 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:41:35,892 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:50:19,282 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:50:21,024 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:50:21,038 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:51:58,798 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 78, in run
    errors = label.shape[0] - torch.sum(predictions  == label)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/_tensor.py", line 544, in __rsub__
    return _C._VariableFunctions.rsub(self, other)
TypeError: rsub() received an invalid combination of arguments - got (Tensor, torch.Size), but expected one of:
 * (Tensor input, Tensor other, *, Number alpha)
 * (Tensor input, Number other, Number alpha)

[2022-01-20 16:52:48,749 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:52:49,650 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:52:49,664 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:54:01,863 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:54:02,760 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:54:02,771 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:57:18,210 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:57:19,133 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:57:19,143 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:57:19,520 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 70, in run
    model = MobileNetV3Module.load_from_checkpoint(checkpoint_path="./checkpoints/"+checkpoint_name, rgb_img=rgb_img, mode=args.mode)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 131, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 32, in load
    with fs.open(path_or_url, "rb") as f:
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/spec.py", line 1006, in open
    f = self._open(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/implementations/local.py", line 155, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/implementations/local.py", line 250, in __init__
    self._open()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/fsspec/implementations/local.py", line 255, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/home/doni-lab-ai/Documenti/NeuralNetwork-project/./checkpoints/mobilenetv3-small-mnist.ckpt'
[2022-01-20 16:57:33,827 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:57:34,789 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:57:34,799 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:57:40,993 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 80, in run
    predictions =  torch.argmax(model(image), dim=1)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2022-01-20 16:58:13,082 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 16:58:14,014 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 16:58:14,024 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:03:41,675 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 17:03:42,560 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:03:42,570 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:03:42,910 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 17:03:42,911 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:03:42,912 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 17:03:43,885 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 17:03:43,886 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 17:03:43,886 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 17:03:43,886 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 17:03:43,886 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 17:03:43,951 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 17:03:44,874 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:03:44,884 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:03:45,176 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 17:03:45,177 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:03:45,177 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 17:03:45,673 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:03:45,676 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 17:03:46,192 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 17:03:46,192 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 17:03:46,193 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:03:46,194 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 17:03:46,194 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 17:03:46,201 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 17:03:46,201 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 17:03:46,202 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 17:03:46,205 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 17:03:49,889 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 17:03:49,890 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 17:03:49,958 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:03:50,075 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 17:03:50,083 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 17:03:50,090 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 17:03:50,097 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 17:03:53,265 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-20 17:03:57,573 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:03:57,573 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:05:42,555 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 17:05:43,462 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:05:43,472 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:05:43,867 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 17:05:43,869 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:05:43,869 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 17:05:44,836 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-20 17:05:44,836 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-20 17:05:44,836 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-20 17:05:44,836 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 17:05:44,837 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 17:05:44,909 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-20 17:05:45,844 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:05:45,854 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:05:46,152 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-20 17:05:46,153 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:05:46,154 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-20 17:05:46,624 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:05:46,627 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-20 17:05:47,170 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-20 17:05:47,170 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-20 17:05:47,170 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:05:47,171 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-20 17:05:47,172 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-20 17:05:47,173 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-20 17:05:47,173 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-20 17:05:47,173 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-20 17:05:47,182 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-20 17:05:50,901 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 17:05:50,901 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-20 17:05:50,993 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:05:51,136 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 17:05:51,142 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-20 17:05:51,151 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 17:05:51,157 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-20 17:05:54,182 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-20 17:05:59,104 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:05:59,108 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-20 17:16:58,391 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-20 17:16:59,787 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:16:59,798 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-20 17:47:56,862 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-20 17:47:56,870 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-20 17:47:56,908 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  2532.0         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  50.35          	|50             	|  2517.5         	|  99.426         	|
run_training_batch                 	|  0.37845        	|5250           	|  1986.8         	|  78.468         	|
model_forward                      	|  0.36012        	|5250           	|  1890.6         	|  74.668         	|
training_step                      	|  0.36001        	|5250           	|  1890.1         	|  74.646         	|
closure_0                          	|  0.2443         	|5250           	|  1282.6         	|  50.654         	|
get_train_batch                    	|  0.045256       	|5250           	|  237.59         	|  9.3835         	|
evaluation_step_and_end            	|  0.095506       	|1052           	|  100.47         	|  3.9681         	|
validation_step                    	|  0.095405       	|1052           	|  100.37         	|  3.9638         	|
training_batch_to_device           	|  0.00027053     	|5250           	|  1.4203         	|  0.056092       	|
on_train_batch_end                 	|  0.00020958     	|5250           	|  1.1003         	|  0.043454       	|
on_train_epoch_end                 	|  0.016104       	|50             	|  0.80518        	|  0.0318         	|
on_after_backward                  	|  6.4377e-05     	|5250           	|  0.33798        	|  0.013348       	|
evaluation_batch_to_device         	|  0.00029726     	|1052           	|  0.31272        	|  0.01235        	|
on_before_optimizer_step           	|  4.5718e-05     	|5250           	|  0.24002        	|  0.0094793      	|
on_validation_batch_end            	|  0.00020213     	|1052           	|  0.21264        	|  0.0083979      	|
on_before_backward                 	|  3.2115e-05     	|5250           	|  0.16861        	|  0.0066589      	|
on_batch_start                     	|  2.4586e-05     	|5250           	|  0.12908        	|  0.0050977      	|
on_train_batch_start               	|  2.3305e-05     	|5250           	|  0.12235        	|  0.0048322      	|
on_batch_end                       	|  2.0533e-05     	|5250           	|  0.1078         	|  0.0042573      	|
on_validation_end                  	|  0.0020731      	|51             	|  0.10573        	|  0.0041757      	|
training_step_end                  	|  1.9064e-05     	|5250           	|  0.10009        	|  0.0039528      	|
on_validation_start                	|  0.00096782     	|51             	|  0.049359       	|  0.0019494      	|
on_train_epoch_start               	|  0.00085728     	|50             	|  0.042864       	|  0.0016929      	|
on_validation_batch_start          	|  3.8052e-05     	|1052           	|  0.04003        	|  0.001581       	|
validation_step_end                	|  2.0274e-05     	|1052           	|  0.021328       	|  0.00084233     	|
on_train_start                     	|  0.0048116      	|1              	|  0.0048116      	|  0.00019003     	|
on_epoch_end                       	|  3.8217e-05     	|101            	|  0.0038599      	|  0.00015244     	|
on_epoch_start                     	|  3.1762e-05     	|101            	|  0.003208       	|  0.0001267      	|
on_validation_epoch_end            	|  5.7387e-05     	|51             	|  0.0029268      	|  0.00011559     	|
on_validation_epoch_start          	|  2.6531e-05     	|51             	|  0.0013531      	|  5.3438e-05     	|
on_train_end                       	|  0.00069621     	|1              	|  0.00069621     	|  2.7496e-05     	|
on_fit_start                       	|  5.6628e-05     	|1              	|  5.6628e-05     	|  2.2364e-06     	|
on_train_dataloader                	|  4.3369e-05     	|1              	|  4.3369e-05     	|  1.7128e-06     	|
on_val_dataloader                  	|  2.1895e-05     	|1              	|  2.1895e-05     	|  8.6473e-07     	|
on_before_accelerator_backend_setup	|  8.5402e-06     	|1              	|  8.5402e-06     	|  3.3729e-07     	|

[2022-01-21 13:12:44,353 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:12:46,063 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:12:46,077 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:12:46,807 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:12:46,809 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:12:46,810 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:12:47,804 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 13:12:47,804 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 13:12:47,804 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 13:12:47,805 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:12:47,805 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:12:48,571 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:12:49,597 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:12:49,602 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 13:12:50,341 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:12:50,354 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:12:51,071 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:12:51,073 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:12:51,075 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:12:52,104 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:12:52,105 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:12:52,107 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:12:52,110 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 13:12:52,111 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 13:12:52,113 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 13:12:52,114 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 13:12:52,115 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 13:12:52,122 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 13:12:55,799 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:12:55,800 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:12:55,936 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:12:56,102 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:12:56,111 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 13:12:56,127 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:12:56,134 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 13:13:00,593 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-21 13:19:13,276 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:19:14,172 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:14,186 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:14,568 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:19:14,569 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:19:14,569 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:19:30,806 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:19:31,710 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:31,721 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:32,017 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:19:32,018 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:19:32,019 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:19:32,968 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 13:19:32,968 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 13:19:32,968 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 13:19:32,968 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:19:32,968 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:19:33,033 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:19:34,011 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:34,022 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:34,328 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:19:34,329 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:19:34,329 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:19:34,755 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:19:34,758 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 13:19:35,295 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:19:35,296 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:19:35,296 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:19:35,297 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 13:19:35,298 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 13:19:35,303 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 13:19:35,303 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 13:19:35,304 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 13:19:35,308 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 13:19:39,006 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:19:39,006 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:19:39,075 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:19:39,219 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:19:39,225 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 13:19:39,234 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:19:39,240 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 13:19:42,428 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-21 13:19:47,305 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:19:47,306 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:24:22,856 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:24:22,863 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 13:24:22,877 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  289.9          	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  27.547         	|10             	|  275.47         	|  95.023         	|
run_training_batch                 	|  0.17893        	|1050           	|  187.87         	|  64.806         	|
model_forward                      	|  0.15912        	|1050           	|  167.08         	|  57.634         	|
training_step                      	|  0.15901        	|1050           	|  166.96         	|  57.593         	|
closure_0                          	|  0.11072        	|1050           	|  116.26         	|  40.102         	|
get_train_batch                    	|  0.040441       	|1050           	|  42.463         	|  14.648         	|
evaluation_step_and_end            	|  0.045976       	|212            	|  9.747          	|  3.3622         	|
validation_step                    	|  0.045875       	|212            	|  9.7256         	|  3.3548         	|
training_batch_to_device           	|  0.00032784     	|1050           	|  0.34424        	|  0.11874        	|
on_train_batch_end                 	|  0.00030001     	|1050           	|  0.31501        	|  0.10866        	|
on_train_epoch_end                 	|  0.015049       	|10             	|  0.15049        	|  0.051912       	|
evaluation_batch_to_device         	|  0.00050587     	|212            	|  0.10724        	|  0.036993       	|
on_after_backward                  	|  5.1676e-05     	|1050           	|  0.054259       	|  0.018717       	|
on_validation_batch_end            	|  0.00017773     	|212            	|  0.037678       	|  0.012997       	|
on_before_backward                 	|  3.5586e-05     	|1050           	|  0.037365       	|  0.012889       	|
on_before_optimizer_step           	|  3.3251e-05     	|1050           	|  0.034913       	|  0.012043       	|
on_batch_start                     	|  2.6468e-05     	|1050           	|  0.027791       	|  0.0095866      	|
on_train_batch_start               	|  2.4021e-05     	|1050           	|  0.025222       	|  0.0087001      	|
on_batch_end                       	|  2.1323e-05     	|1050           	|  0.02239        	|  0.0077232      	|
on_validation_end                  	|  0.0018621      	|11             	|  0.020483       	|  0.0070654      	|
training_step_end                  	|  1.9308e-05     	|1050           	|  0.020273       	|  0.0069931      	|
on_validation_batch_start          	|  4.0071e-05     	|212            	|  0.0084951      	|  0.0029303      	|
on_validation_start                	|  0.00075002     	|11             	|  0.0082502      	|  0.0028459      	|
on_train_epoch_start               	|  0.00068942     	|10             	|  0.0068942      	|  0.0023781      	|
validation_step_end                	|  1.9687e-05     	|212            	|  0.0041736      	|  0.0014397      	|
on_train_start                     	|  0.0040705      	|1              	|  0.0040705      	|  0.0014041      	|
on_epoch_end                       	|  3.0081e-05     	|21             	|  0.00063169     	|  0.0002179      	|
on_epoch_start                     	|  2.9585e-05     	|21             	|  0.00062129     	|  0.00021431     	|
on_validation_epoch_end            	|  5.6275e-05     	|11             	|  0.00061903     	|  0.00021353     	|
on_train_end                       	|  0.00034268     	|1              	|  0.00034268     	|  0.00011821     	|
on_validation_epoch_start          	|  2.5066e-05     	|11             	|  0.00027573     	|  9.5111e-05     	|
on_fit_start                       	|  5.5065e-05     	|1              	|  5.5065e-05     	|  1.8994e-05     	|
on_train_dataloader                	|  3.3173e-05     	|1              	|  3.3173e-05     	|  1.1443e-05     	|
on_val_dataloader                  	|  2.0402e-05     	|1              	|  2.0402e-05     	|  7.0376e-06     	|
on_before_accelerator_backend_setup	|  1.284e-05      	|1              	|  1.284e-05      	|  4.4292e-06     	|

[2022-01-21 13:30:24,775 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:30:25,692 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:30:25,703 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:30:26,024 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:30:26,025 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:30:26,026 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:30:26,996 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 13:30:26,997 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 13:30:26,997 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 13:30:26,997 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:30:26,997 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:30:27,064 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:30:28,003 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:30:28,015 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:30:28,319 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:30:28,320 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:30:28,320 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:30:28,785 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:30:28,787 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 13:30:29,331 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:30:29,332 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:30:29,332 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:30:29,333 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 13:30:29,334 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 13:30:29,342 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 13:30:29,343 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 13:30:29,343 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 13:30:29,344 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 13:30:33,437 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:30:33,438 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:30:33,498 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:30:33,627 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:30:33,635 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 13:30:33,643 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:30:33,648 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 13:30:36,815 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-21 13:30:46,130 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 990, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1035, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1122, in _run_sanity_check
    self._evaluation_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 94, in advance
    batch_idx, batch = next(dataloader_iter)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1186, in _next_data
    idx, data = self._get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1142, in _get_data
    success, data = self._try_get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1003, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 2794, 2864, 2962, 3027, 3091) exited unexpectedly
[2022-01-21 13:30:46,451 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 990, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1035, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1122, in _run_sanity_check
    self._evaluation_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 94, in advance
    batch_idx, batch = next(dataloader_iter)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1186, in _next_data
    idx, data = self._get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1142, in _get_data
    success, data = self._try_get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1003, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 2826, 2930, 2995, 3059) exited unexpectedly
[2022-01-21 13:31:19,562 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:31:20,509 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:31:20,521 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:31:20,831 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:31:20,831 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:31:20,832 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:31:21,797 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 13:31:21,797 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 13:31:21,797 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 13:31:21,797 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:31:21,797 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:31:21,866 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 13:31:22,818 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:31:22,828 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:31:23,123 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 13:31:23,124 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:31:23,125 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 13:31:23,585 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:31:23,587 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 13:31:24,072 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 13:31:24,073 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 13:31:24,073 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:31:24,074 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 13:31:24,075 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 13:31:24,081 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 13:31:24,082 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 13:31:24,082 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 13:31:24,085 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 13:31:27,945 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:31:27,945 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 13:31:28,002 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 13:31:28,129 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:31:28,137 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 13:31:28,143 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:31:28,149 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 13:31:31,240 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-21 13:31:34,897 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:31:34,897 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 13:36:44,663 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 13:36:44,670 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 13:36:44,689 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  322.88         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  30.965         	|10             	|  309.65         	|  95.903         	|
run_training_batch                 	|  0.15479        	|1050           	|  162.53         	|  50.338         	|
model_forward                      	|  0.14834        	|1050           	|  155.75         	|  48.238         	|
training_step                      	|  0.14823        	|1050           	|  155.64         	|  48.204         	|
closure_0                          	|  0.10647        	|1050           	|  111.8          	|  34.624         	|
get_train_batch                    	|  0.056235       	|1050           	|  59.046         	|  18.287         	|
training_batch_to_device           	|  0.03599        	|1050           	|  37.79          	|  11.704         	|
evaluation_step_and_end            	|  0.041029       	|212            	|  8.6981         	|  2.6939         	|
validation_step                    	|  0.040931       	|212            	|  8.6774         	|  2.6875         	|
evaluation_batch_to_device         	|  0.034619       	|212            	|  7.3392         	|  2.273          	|
on_train_epoch_end                 	|  0.036693       	|10             	|  0.36693        	|  0.11364        	|
on_train_batch_end                 	|  0.00022003     	|1050           	|  0.23103        	|  0.071553       	|
on_after_backward                  	|  4.6359e-05     	|1050           	|  0.048677       	|  0.015076       	|
on_before_backward                 	|  3.6369e-05     	|1050           	|  0.038187       	|  0.011827       	|
on_validation_batch_end            	|  0.00017921     	|212            	|  0.037992       	|  0.011767       	|
on_before_optimizer_step           	|  3.1653e-05     	|1050           	|  0.033235       	|  0.010293       	|
on_batch_start                     	|  3.1025e-05     	|1050           	|  0.032577       	|  0.010089       	|
on_train_batch_start               	|  2.5078e-05     	|1050           	|  0.026332       	|  0.0081554      	|
on_batch_end                       	|  2.1314e-05     	|1050           	|  0.02238        	|  0.0069312      	|
training_step_end                  	|  1.947e-05      	|1050           	|  0.020444       	|  0.0063316      	|
on_validation_end                  	|  0.0015367      	|11             	|  0.016904       	|  0.0052352      	|
on_validation_batch_start          	|  3.6003e-05     	|212            	|  0.0076327      	|  0.0023639      	|
on_train_epoch_start               	|  0.00064758     	|10             	|  0.0064758      	|  0.0020056      	|
on_validation_start                	|  0.00055807     	|11             	|  0.0061387      	|  0.0019012      	|
validation_step_end                	|  1.9149e-05     	|212            	|  0.0040596      	|  0.0012573      	|
on_train_start                     	|  0.0024137      	|1              	|  0.0024137      	|  0.00074756     	|
on_epoch_end                       	|  2.9744e-05     	|21             	|  0.00062461     	|  0.00019345     	|
on_epoch_start                     	|  2.7653e-05     	|21             	|  0.0005807      	|  0.00017985     	|
on_train_end                       	|  0.00054547     	|1              	|  0.00054547     	|  0.00016894     	|
on_validation_epoch_end            	|  4.1188e-05     	|11             	|  0.00045307     	|  0.00014032     	|
on_validation_epoch_start          	|  2.1981e-05     	|11             	|  0.00024179     	|  7.4886e-05     	|
on_fit_start                       	|  3.7754e-05     	|1              	|  3.7754e-05     	|  1.1693e-05     	|
on_val_dataloader                  	|  2.7267e-05     	|1              	|  2.7267e-05     	|  8.4449e-06     	|
on_train_dataloader                	|  2.4178e-05     	|1              	|  2.4178e-05     	|  7.4881e-06     	|
on_before_accelerator_backend_setup	|  9.5791e-06     	|1              	|  9.5791e-06     	|  2.9668e-06     	|

[2022-01-21 14:55:27,501 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 14:55:29,238 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 14:55:29,253 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:01:27,608 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:01:29,314 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:01:29,328 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:03:19,205 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:03:20,897 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:03:20,910 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:05:46,407 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:05:48,067 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:05:48,081 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:05:57,269 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/test.py", line 88, in run
    labels.append(*label.tolist())
TypeError: append() takes exactly one argument (240 given)
[2022-01-21 15:07:19,393 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:07:21,057 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:07:21,070 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:12:13,840 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:12:14,759 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:12:14,770 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:14:13,538 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:14:14,443 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:14:14,455 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:16:32,207 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 15:16:33,125 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:16:33,136 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:16:33,450 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 15:16:33,451 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:16:33,452 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 15:16:34,430 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 15:16:34,430 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 15:16:34,430 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 15:16:34,430 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 15:16:34,430 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 15:16:34,501 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 15:16:35,425 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:16:35,435 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:16:35,727 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 15:16:35,728 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:16:35,728 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 15:16:36,217 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:16:36,220 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 15:16:36,736 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 15:16:36,736 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 15:16:36,737 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:16:36,738 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 15:16:36,739 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 15:16:36,746 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 15:16:36,746 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 15:16:36,746 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 15:16:36,749 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 15:16:40,602 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 15:16:40,602 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 15:16:40,697 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:16:40,861 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 15:16:40,869 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 15:16:40,874 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 15:16:40,881 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 15:16:43,884 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-21 15:16:47,384 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:16:47,384 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:16:54,642 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 133, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
RuntimeError: CUDA out of memory. Tried to allocate 34.00 MiB (GPU 0; 23.65 GiB total capacity; 8.95 GiB already allocated; 11.94 MiB free; 9.04 GiB reserved in total by PyTorch)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1062, in _run_train
    self.training_type_plugin.reconciliate_processes(traceback.format_exc())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 478, in reconciliate_processes
    raise DeadlockDetectedException(f"DeadLock detected from rank: {self.global_rank} \n {trace}")
pytorch_lightning.utilities.exceptions.DeadlockDetectedException: DeadLock detected from rank: 0 
 Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 257, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 133, in forward
    out = self.non_lin(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 62, in forward
    return x * self.hsigmoid(x)
RuntimeError: CUDA out of memory. Tried to allocate 34.00 MiB (GPU 0; 23.65 GiB total capacity; 8.95 GiB already allocated; 11.94 MiB free; 9.04 GiB reserved in total by PyTorch)

[2022-01-21 15:20:22,807 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 15:20:23,724 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:20:23,735 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:20:24,038 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 15:20:24,039 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:20:24,039 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 15:20:24,108 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 15:20:24,108 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 15:20:24,108 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 15:20:24,108 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 15:20:24,108 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 15:20:24,171 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 15:20:25,085 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:20:25,095 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:20:25,393 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 15:20:25,394 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:20:25,394 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 15:20:25,460 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 15:20:25,460 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 15:20:25,461 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:20:25,462 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 15:20:25,889 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:20:25,893 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 15:20:26,463 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 15:20:26,468 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 15:20:26,469 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 15:20:26,469 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 15:20:26,474 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 15:20:30,252 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 15:20:30,252 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 15:20:30,315 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:20:30,439 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 15:20:30,445 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 15:20:30,452 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 15:20:30,458 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 15:20:33,477 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.085     Total estimated model params size (MB)
[2022-01-21 15:20:36,253 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:20:36,253 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 15:43:34,085 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 15:43:34,090 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 15:43:34,120 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  1390.0         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  27.546         	|50             	|  1377.3         	|  99.089         	|
run_training_batch                 	|  0.15289        	|6250           	|  955.58         	|  68.747         	|
model_forward                      	|  0.14695        	|6250           	|  918.43         	|  66.075         	|
training_step                      	|  0.14685        	|6250           	|  917.83         	|  66.031         	|
closure_0                          	|  0.1061         	|6250           	|  663.12         	|  47.707         	|
get_train_batch                    	|  0.029886       	|6250           	|  186.79         	|  13.438         	|
training_batch_to_device           	|  0.0081627      	|6250           	|  51.017         	|  3.6703         	|
evaluation_step_and_end            	|  0.040664       	|1052           	|  42.779         	|  3.0776         	|
validation_step                    	|  0.04057        	|1052           	|  42.679         	|  3.0705         	|
evaluation_batch_to_device         	|  0.0082341      	|1052           	|  8.6622         	|  0.62319        	|
on_train_batch_end                 	|  0.00019242     	|6250           	|  1.2026         	|  0.086522       	|
on_train_epoch_end                 	|  0.0069985      	|50             	|  0.34992        	|  0.025175       	|
on_after_backward                  	|  4.1028e-05     	|6250           	|  0.25642        	|  0.018448       	|
on_batch_start                     	|  2.9791e-05     	|6250           	|  0.18619        	|  0.013395       	|
on_before_backward                 	|  2.9578e-05     	|6250           	|  0.18486        	|  0.0133         	|
on_validation_batch_end            	|  0.00016857     	|1052           	|  0.17734        	|  0.012758       	|
on_before_optimizer_step           	|  2.8281e-05     	|6250           	|  0.17676        	|  0.012717       	|
on_train_batch_start               	|  2.4125e-05     	|6250           	|  0.15078        	|  0.010848       	|
on_batch_end                       	|  1.9842e-05     	|6250           	|  0.12401        	|  0.0089219      	|
training_step_end                  	|  1.6216e-05     	|6250           	|  0.10135        	|  0.0072915      	|
on_validation_end                  	|  0.0018017      	|51             	|  0.091888       	|  0.0066107      	|
on_validation_batch_start          	|  3.3616e-05     	|1052           	|  0.035364       	|  0.0025442      	|
on_train_epoch_start               	|  0.00069009     	|50             	|  0.034505       	|  0.0024824      	|
on_validation_start                	|  0.00061452     	|51             	|  0.03134        	|  0.0022547      	|
validation_step_end                	|  2.0642e-05     	|1052           	|  0.021715       	|  0.0015623      	|
on_train_start                     	|  0.0035059      	|1              	|  0.0035059      	|  0.00025222     	|
on_epoch_end                       	|  3.2248e-05     	|101            	|  0.003257       	|  0.00023432     	|
on_epoch_start                     	|  2.6236e-05     	|101            	|  0.0026498      	|  0.00019064     	|
on_validation_epoch_end            	|  5.1211e-05     	|51             	|  0.0026117      	|  0.0001879      	|
on_validation_epoch_start          	|  2.1074e-05     	|51             	|  0.0010748      	|  7.7324e-05     	|
on_train_end                       	|  0.00049978     	|1              	|  0.00049978     	|  3.5956e-05     	|
on_fit_start                       	|  5.6114e-05     	|1              	|  5.6114e-05     	|  4.037e-06      	|
on_val_dataloader                  	|  5.2244e-05     	|1              	|  5.2244e-05     	|  3.7586e-06     	|
on_train_dataloader                	|  1.9763e-05     	|1              	|  1.9763e-05     	|  1.4218e-06     	|
on_before_accelerator_backend_setup	|  9.8981e-06     	|1              	|  9.8981e-06     	|  7.121e-07      	|

[2022-01-21 15:44:42,176 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:44:43,105 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:44:43,116 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:46:21,851 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:46:22,746 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:46:22,757 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:48:51,203 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 15:48:52,107 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 15:48:52,118 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:25:08,401 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 16:25:09,318 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:25:09,329 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:25:09,645 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 16:25:09,646 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:25:09,647 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 16:25:09,710 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 16:25:09,710 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 16:25:09,710 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 16:25:09,711 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 16:25:09,711 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 16:25:09,772 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 16:25:10,647 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:25:10,657 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:25:10,949 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 16:25:10,950 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:25:10,951 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 16:25:11,012 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 16:25:11,012 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 16:25:11,013 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:25:11,014 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 16:25:11,491 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:25:11,494 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 16:25:12,015 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 16:25:12,021 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 16:25:12,021 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 16:25:12,022 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 16:25:12,026 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 16:25:15,889 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 16:25:15,889 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 16:25:15,953 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:25:16,078 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 16:25:16,085 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 16:25:16,091 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 16:25:16,097 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 16:25:19,085 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.085     Total estimated model params size (MB)
[2022-01-21 16:25:21,869 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:25:21,869 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:41:06,852 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 16:41:07,802 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:41:07,813 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:42:47,184 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 16:42:48,210 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:42:48,220 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:48:29,042 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 16:48:29,050 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 16:48:29,090 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  1399.3         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  27.732         	|50             	|  1386.6         	|  99.088         	|
run_training_batch                 	|  0.15977        	|5900           	|  942.63         	|  67.362         	|
model_forward                      	|  0.15347        	|5900           	|  905.5          	|  64.709         	|
training_step                      	|  0.15337        	|5900           	|  904.86         	|  64.663         	|
get_train_batch                    	|  0.033928       	|5900           	|  200.17         	|  14.305         	|
training_batch_to_device           	|  0.0089729      	|5900           	|  52.94          	|  3.7832         	|
closure_0                          	|  0.0072837      	|5900           	|  42.974         	|  3.071          	|
evaluation_step_and_end            	|  0.042573       	|1002           	|  42.658         	|  3.0484         	|
validation_step                    	|  0.042472       	|1002           	|  42.557         	|  3.0412         	|
evaluation_batch_to_device         	|  0.0086997      	|1002           	|  8.7171         	|  0.62294        	|
on_train_batch_end                 	|  0.00023511     	|5900           	|  1.3871         	|  0.099126       	|
on_after_backward                  	|  4.8708e-05     	|5900           	|  0.28738        	|  0.020537       	|
on_train_epoch_end                 	|  0.0051814      	|50             	|  0.25907        	|  0.018514       	|
on_before_optimizer_step           	|  3.6466e-05     	|5900           	|  0.21515        	|  0.015375       	|
on_validation_batch_end            	|  0.00021076     	|1002           	|  0.21119        	|  0.015092       	|
on_before_backward                 	|  3.5113e-05     	|5900           	|  0.20717        	|  0.014805       	|
on_batch_start                     	|  3.3863e-05     	|5900           	|  0.19979        	|  0.014277       	|
on_train_batch_start               	|  2.8453e-05     	|5900           	|  0.16787        	|  0.011997       	|
on_batch_end                       	|  2.0038e-05     	|5900           	|  0.11823        	|  0.0084487      	|
training_step_end                  	|  1.9033e-05     	|5900           	|  0.1123         	|  0.0080248      	|
on_validation_end                  	|  0.0020522      	|51             	|  0.10466        	|  0.0074792      	|
on_train_epoch_start               	|  0.00076297     	|50             	|  0.038149       	|  0.0027262      	|
on_validation_start                	|  0.00070047     	|51             	|  0.035724       	|  0.0025529      	|
on_validation_batch_start          	|  3.3837e-05     	|1002           	|  0.033905       	|  0.0024229      	|
validation_step_end                	|  2.0017e-05     	|1002           	|  0.020057       	|  0.0014333      	|
on_train_start                     	|  0.004063       	|1              	|  0.004063       	|  0.00029035     	|
on_epoch_end                       	|  3.5605e-05     	|101            	|  0.0035962      	|  0.00025699     	|
on_validation_epoch_end            	|  5.6996e-05     	|51             	|  0.0029068      	|  0.00020773     	|
on_epoch_start                     	|  2.57e-05       	|101            	|  0.0025957      	|  0.00018549     	|
on_validation_epoch_start          	|  2.1714e-05     	|51             	|  0.0011074      	|  7.9138e-05     	|
on_train_end                       	|  0.00046619     	|1              	|  0.00046619     	|  3.3315e-05     	|
on_fit_start                       	|  4.958e-05      	|1              	|  4.958e-05      	|  3.5431e-06     	|
on_train_dataloader                	|  1.9087e-05     	|1              	|  1.9087e-05     	|  1.364e-06      	|
on_val_dataloader                  	|  1.8803e-05     	|1              	|  1.8803e-05     	|  1.3437e-06     	|
on_before_accelerator_backend_setup	|  9.9638e-06     	|1              	|  9.9638e-06     	|  7.1203e-07     	|

[2022-01-21 16:53:20,918 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 16:53:21,821 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:53:21,832 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:53:22,149 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 16:53:22,150 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:53:22,151 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 16:53:22,215 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 16:53:22,215 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 16:53:22,215 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 16:53:22,216 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 16:53:22,216 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 16:53:22,283 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 16:53:23,164 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:53:23,174 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:53:23,467 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 16:53:23,467 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:53:23,468 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 16:53:23,529 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 16:53:23,529 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 16:53:23,530 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:53:23,530 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 16:53:23,999 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:53:24,002 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 16:53:24,532 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 16:53:24,540 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 16:53:24,540 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 16:53:24,540 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 16:53:24,543 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 16:53:28,367 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 16:53:28,367 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 16:53:28,430 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 16:53:28,612 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 16:53:28,619 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 16:53:28,627 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 16:53:28,633 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 16:53:31,684 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.085     Total estimated model params size (MB)
[2022-01-21 16:53:34,472 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 16:53:34,472 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:02:42,731 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:02:42,737 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 17:02:42,755 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  560.52         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  27.401         	|20             	|  548.03         	|  97.771         	|
run_training_batch                 	|  0.15852        	|2360           	|  374.12         	|  66.744         	|
model_forward                      	|  0.15241        	|2360           	|  359.69         	|  64.171         	|
training_step                      	|  0.15231        	|2360           	|  359.45         	|  64.128         	|
get_train_batch                    	|  0.033511       	|2360           	|  79.086         	|  14.109         	|
training_batch_to_device           	|  0.0086455      	|2360           	|  20.403         	|  3.64           	|
closure_0                          	|  0.0073162      	|2360           	|  17.266         	|  3.0803         	|
evaluation_step_and_end            	|  0.042419       	|402            	|  17.053         	|  3.0423         	|
validation_step                    	|  0.042321       	|402            	|  17.013         	|  3.0352         	|
evaluation_batch_to_device         	|  0.0083263      	|402            	|  3.3472         	|  0.59715        	|
on_train_batch_end                 	|  0.00022134     	|2360           	|  0.52236        	|  0.093192       	|
on_train_epoch_end                 	|  0.0077928      	|20             	|  0.15586        	|  0.027805       	|
on_after_backward                  	|  4.9718e-05     	|2360           	|  0.11734        	|  0.020933       	|
on_validation_batch_end            	|  0.00020925     	|402            	|  0.084118       	|  0.015007       	|
on_before_optimizer_step           	|  3.4204e-05     	|2360           	|  0.080722       	|  0.014401       	|
on_before_backward                 	|  3.0514e-05     	|2360           	|  0.072013       	|  0.012847       	|
on_batch_start                     	|  3.0275e-05     	|2360           	|  0.07145        	|  0.012747       	|
on_train_batch_start               	|  2.5702e-05     	|2360           	|  0.060658       	|  0.010822       	|
on_batch_end                       	|  1.9541e-05     	|2360           	|  0.046116       	|  0.0082273      	|
training_step_end                  	|  1.8301e-05     	|2360           	|  0.043191       	|  0.0077054      	|
on_validation_end                  	|  0.0017237      	|21             	|  0.036198       	|  0.0064578      	|
on_validation_start                	|  0.00067767     	|21             	|  0.014231       	|  0.0025389      	|
on_validation_batch_start          	|  3.3277e-05     	|402            	|  0.013377       	|  0.0023866      	|
on_train_epoch_start               	|  0.0006063      	|20             	|  0.012126       	|  0.0021633      	|
validation_step_end                	|  1.981e-05      	|402            	|  0.0079634      	|  0.0014207      	|
on_train_start                     	|  0.0030955      	|1              	|  0.0030955      	|  0.00055225     	|
on_epoch_end                       	|  3.5596e-05     	|41             	|  0.0014594      	|  0.00026037     	|
on_validation_epoch_end            	|  5.3176e-05     	|21             	|  0.0011167      	|  0.00019922     	|
on_epoch_start                     	|  2.6673e-05     	|41             	|  0.0010936      	|  0.0001951      	|
on_validation_epoch_start          	|  2.1058e-05     	|21             	|  0.00044222     	|  7.8894e-05     	|
on_train_end                       	|  0.00038786     	|1              	|  0.00038786     	|  6.9196e-05     	|
on_fit_start                       	|  5.0819e-05     	|1              	|  5.0819e-05     	|  9.0663e-06     	|
on_val_dataloader                  	|  2.7152e-05     	|1              	|  2.7152e-05     	|  4.844e-06      	|
on_train_dataloader                	|  2.0769e-05     	|1              	|  2.0769e-05     	|  3.7053e-06     	|
on_before_accelerator_backend_setup	|  8.6478e-06     	|1              	|  8.6478e-06     	|  1.5428e-06     	|

[2022-01-21 17:03:13,477 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:03:14,417 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:03:14,429 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:06:50,529 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:06:51,432 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:06:51,443 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:09:40,646 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:09:42,408 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:09:42,423 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:12:24,487 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:12:25,433 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:12:25,445 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:14:39,863 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:14:40,763 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:14:40,776 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:14:41,097 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:14:41,098 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:14:41,099 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:14:41,169 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 17:14:41,169 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 17:14:41,169 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 17:14:41,169 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:14:41,170 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:14:41,238 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:14:42,149 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:14:42,159 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:14:42,463 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:14:42,464 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:14:42,464 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:14:42,526 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:14:42,526 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:14:42,527 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:14:42,528 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 17:14:42,954 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:14:42,957 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 17:14:43,529 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 17:14:43,536 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 17:14:43,536 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 17:14:43,537 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 17:14:43,540 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 17:14:47,333 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:14:47,333 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:14:47,396 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:14:47,525 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:14:47,531 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 17:14:47,536 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:14:47,542 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 17:14:50,614 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.085     Total estimated model params size (MB)
[2022-01-21 17:14:53,138 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:14:53,140 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:20:52,471 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:20:53,564 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:20:53,574 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:22:24,533 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 990, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/multiprocessing/queues.py", line 108, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 118, in advance
    _, (batch, is_last) = next(dataloader_iter)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/profiler/base.py", line 104, in profile_iterable
    value = next(iterator)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 668, in prefetch_iterator
    last = next(it)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 589, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 617, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next_fn)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 96, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 604, in next_fn
    batch = next(iterator)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1186, in _next_data
    idx, data = self._get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1152, in _get_data
    success, data = self._try_get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1003, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 16027, 16092, 16156, 16224, 16293, 16357, 16432, 16498, 16563, 16627, 16691, 16781, 16852, 16940, 17093, 17157, 17279) exited unexpectedly
[2022-01-21 17:22:24,725 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 990, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/multiprocessing/queues.py", line 108, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 118, in advance
    _, (batch, is_last) = next(dataloader_iter)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/profiler/base.py", line 104, in profile_iterable
    value = next(iterator)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 668, in prefetch_iterator
    last = next(it)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 589, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 617, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next_fn)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 96, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 604, in next_fn
    batch = next(iterator)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1186, in _next_data
    idx, data = self._get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1152, in _get_data
    success, data = self._try_get_data()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1003, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 16056, 16124, 16191, 16256, 16325, 16399, 16466, 16530, 16595, 16659, 16723, 16820, 16885, 17005, 17125, 17239, 17319) exited unexpectedly
[2022-01-21 17:22:35,252 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:22:36,147 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:22:36,158 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:23:39,308 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:23:40,207 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:23:40,219 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:24:32,526 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:24:33,427 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:24:33,438 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:27:36,880 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:27:37,783 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:27:37,795 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:27:38,099 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:27:38,100 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:27:38,101 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:27:39,086 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 17:27:39,086 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 17:27:39,086 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 17:27:39,087 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:27:39,087 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:27:39,151 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:27:40,082 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:27:40,094 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:27:40,419 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:27:40,420 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:27:40,420 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:27:40,875 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:27:40,877 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 17:27:41,398 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:27:41,399 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:27:41,399 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:27:41,400 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 17:27:41,401 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 17:27:41,404 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 17:27:41,404 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 17:27:41,405 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 17:27:41,411 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 17:27:45,202 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:27:45,202 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:27:45,290 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:27:45,437 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:27:45,444 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 17:27:45,451 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:27:45,457 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 17:27:48,524 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-21 17:27:55,414 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 254, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 125, in forward
    out = self.conv2d_pw(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 194.00 MiB (GPU 0; 23.65 GiB total capacity; 1.12 GiB already allocated; 42.94 MiB free; 1.14 GiB reserved in total by PyTorch)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1062, in _run_train
    self.training_type_plugin.reconciliate_processes(traceback.format_exc())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 478, in reconciliate_processes
    raise DeadlockDetectedException(f"DeadLock detected from rank: {self.global_rank} \n {trace}")
pytorch_lightning.utilities.exceptions.DeadlockDetectedException: DeadLock detected from rank: 0 
 Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 254, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 125, in forward
    out = self.conv2d_pw(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 194.00 MiB (GPU 0; 23.65 GiB total capacity; 1.12 GiB already allocated; 42.94 MiB free; 1.14 GiB reserved in total by PyTorch)

[2022-01-21 17:28:04,710 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:28:05,618 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:28:05,632 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:28:05,970 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:28:05,971 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:28:05,972 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:28:06,944 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 17:28:06,944 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 17:28:06,944 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 17:28:06,945 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:28:06,945 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:28:07,021 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:28:07,948 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:28:07,958 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:28:08,256 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:28:08,257 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:28:08,258 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:28:08,737 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:28:08,741 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 17:28:09,249 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:28:09,249 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:28:09,249 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:28:09,250 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 17:28:09,251 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 17:28:09,257 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 17:28:09,258 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 17:28:09,258 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 17:28:09,261 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 17:28:13,317 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:28:13,317 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:28:13,388 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:28:13,522 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:28:13,529 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 17:28:13,537 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:28:13,542 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 17:28:16,654 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-21 17:28:23,181 ERROR @src.logger.base_logger] 25 - The script halted with an error
Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 254, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 136, in forward
    out = self.conv2d_pw_linear(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 98.00 MiB (GPU 0; 23.65 GiB total capacity; 1.04 GiB already allocated; 98.94 MiB free; 1.08 GiB reserved in total by PyTorch)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 22, in run
    mod.run(args)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/train.py", line 162, in run
    trainer.fit(model, train_loader, valid_loader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 552, in fit
    self._run(model)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 922, in _run
    self._dispatch()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _dispatch
    self.accelerator.start_training(self)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 92, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in start_training
    self._results = trainer.run_stage()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1000, in run_stage
    return self._run_train()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1062, in _run_train
    self.training_type_plugin.reconciliate_processes(traceback.format_exc())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 478, in reconciliate_processes
    raise DeadlockDetectedException(f"DeadLock detected from rank: {self.global_rank} \n {trace}")
pytorch_lightning.utilities.exceptions.DeadlockDetectedException: DeadLock detected from rank: 0 
 Traceback (most recent call last):
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1049, in _run_train
    self.fit_loop.run()
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 200, in advance
    epoch_output = self.epoch_loop.run(train_dataloader)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 130, in advance
    batch_output = self.batch_loop.run(batch, self.iteration_count, self._dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 100, in run
    super().run(batch, batch_idx, dataloader_idx)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 111, in run
    self.advance(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 152, in advance
    result = self._run_optimization(batch_idx, split_batch)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 203, in _run_optimization
    result = self._training_step(split_batch, batch_idx, opt_idx, self._hiddens)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 306, in _training_step
    training_step_output = self.trainer.accelerator.training_step(step_kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 193, in training_step
    return self.training_type_plugin.training_step(*step_kwargs.values())
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 389, in training_step
    return self.model(*args, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 82, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 254, in training_step
    logits = self(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 248, in forward
    return self.net(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 179, in forward
    out = self.net_blocks(x)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/Documenti/NeuralNetwork-project/src/mobilenetv3.py", line 136, in forward
    out = self.conv2d_pw_linear(out)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/doni-lab-ai/miniconda3/envs/adgan/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 98.00 MiB (GPU 0; 23.65 GiB total capacity; 1.04 GiB already allocated; 98.94 MiB free; 1.08 GiB reserved in total by PyTorch)

[2022-01-21 17:29:18,035 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:29:18,933 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:29:18,945 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:29:19,248 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:29:19,249 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:29:19,249 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:29:20,212 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 17:29:20,212 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 17:29:20,212 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 17:29:20,212 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:29:20,212 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:29:20,282 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 17:29:21,183 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:29:21,195 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:29:21,512 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 17:29:21,513 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:29:21,514 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 17:29:22,001 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:29:22,003 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 17:29:22,488 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 17:29:22,488 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 17:29:22,488 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 17:29:22,489 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 17:29:22,490 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 17:29:22,500 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 17:29:22,500 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 17:29:22,500 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 17:29:22,501 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 17:29:26,278 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:29:26,278 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 17:29:26,350 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:29:26,470 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:29:26,477 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 17:29:26,481 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:29:26,487 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 17:29:29,586 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
[2022-01-21 17:49:33,351 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 17:49:33,359 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 17:49:33,397 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  1213.2         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  48.134         	|25             	|  1203.3         	|  99.191         	|
run_training_batch                 	|  0.20551        	|4900           	|  1007.0         	|  83.006         	|
model_forward                      	|  0.19955        	|4900           	|  977.81         	|  80.601         	|
training_step                      	|  0.19945        	|4900           	|  977.3          	|  80.558         	|
closure_0                          	|  0.032254       	|4900           	|  158.04         	|  13.027         	|
get_train_batch                    	|  0.026802       	|4900           	|  131.33         	|  10.826         	|
training_batch_to_device           	|  0.012482       	|4900           	|  61.161         	|  5.0415         	|
on_train_batch_end                 	|  0.00020955     	|4900           	|  1.0268         	|  0.084638       	|
on_after_backward                  	|  5.9535e-05     	|4900           	|  0.29172        	|  0.024046       	|
on_train_epoch_end                 	|  0.0096074      	|25             	|  0.24019        	|  0.019798       	|
on_before_optimizer_step           	|  4.6273e-05     	|4900           	|  0.22674        	|  0.01869        	|
on_before_backward                 	|  3.2118e-05     	|4900           	|  0.15738        	|  0.012973       	|
on_batch_start                     	|  2.9081e-05     	|4900           	|  0.1425         	|  0.011746       	|
on_train_batch_start               	|  2.5439e-05     	|4900           	|  0.12465        	|  0.010275       	|
on_batch_end                       	|  1.9526e-05     	|4900           	|  0.095677       	|  0.0078866      	|
training_step_end                  	|  1.906e-05      	|4900           	|  0.093395       	|  0.0076985      	|
on_train_epoch_start               	|  0.00054961     	|25             	|  0.01374        	|  0.0011326      	|
on_train_start                     	|  0.00084213     	|1              	|  0.00084213     	|  6.9417e-05     	|
on_epoch_start                     	|  2.5605e-05     	|25             	|  0.00064012     	|  5.2765e-05     	|
on_epoch_end                       	|  2.0946e-05     	|25             	|  0.00052364     	|  4.3164e-05     	|
on_train_end                       	|  0.00045122     	|1              	|  0.00045122     	|  3.7194e-05     	|
on_fit_start                       	|  3.7062e-05     	|1              	|  3.7062e-05     	|  3.055e-06      	|
on_train_dataloader                	|  3.1569e-05     	|1              	|  3.1569e-05     	|  2.6022e-06     	|
on_before_accelerator_backend_setup	|  9.3388e-06     	|1              	|  9.3388e-06     	|  7.698e-07      	|

[2022-01-21 17:56:59,907 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:57:00,836 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:57:00,846 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:59:11,825 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 17:59:12,718 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 17:59:12,730 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:17,229 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 18:00:18,127 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:18,139 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:18,440 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 18:00:18,441 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:00:18,441 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 18:00:25,276 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 18:00:26,166 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:26,178 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:26,478 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 18:00:26,479 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:00:26,479 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 18:00:27,434 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 18:00:27,434 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 18:00:27,434 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 18:00:27,434 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 18:00:27,434 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 18:00:27,506 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 18:00:28,463 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:28,474 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:28,780 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 18:00:28,781 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:00:28,782 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 18:00:29,221 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:00:29,224 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 18:00:29,801 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 18:00:29,802 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 18:00:29,802 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:00:29,803 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 18:00:29,804 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 18:00:29,813 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 18:00:29,814 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 18:00:29,814 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 18:00:29,814 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 18:00:33,623 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 18:00:33,623 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 18:00:33,687 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:00:33,817 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 18:00:33,826 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 18:00:33,832 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 18:00:33,838 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 18:00:36,939 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 1.5 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
1.5 M     Trainable params
0         Non-trainable params
1.5 M     Total params
6.086     Total estimated model params size (MB)
[2022-01-21 18:11:48,090 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 18:11:48,097 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 58
[2022-01-21 18:11:48,137 INFO @pytorch_lightning.profiler.base] 113 - FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  680.68         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  26.828         	|25             	|  670.7          	|  98.534         	|
run_training_batch                 	|  0.088968       	|4900           	|  435.95         	|  64.046         	|
model_forward                      	|  0.082745       	|4900           	|  405.45         	|  59.565         	|
training_step                      	|  0.082642       	|4900           	|  404.95         	|  59.492         	|
get_train_batch                    	|  0.028029       	|4900           	|  137.34         	|  20.177         	|
training_batch_to_device           	|  0.019065       	|4900           	|  93.421         	|  13.725         	|
closure_0                          	|  0.0036656      	|4900           	|  17.962         	|  2.6388         	|
on_train_batch_end                 	|  0.00021764     	|4900           	|  1.0664         	|  0.15667        	|
on_after_backward                  	|  4.4248e-05     	|4900           	|  0.21681        	|  0.031853       	|
on_train_epoch_end                 	|  0.0080658      	|25             	|  0.20165        	|  0.029624       	|
on_before_optimizer_step           	|  3.2519e-05     	|4900           	|  0.15934        	|  0.023409       	|
on_before_backward                 	|  3.1928e-05     	|4900           	|  0.15645        	|  0.022984       	|
on_batch_start                     	|  3.1552e-05     	|4900           	|  0.15461        	|  0.022714       	|
on_train_batch_start               	|  2.7021e-05     	|4900           	|  0.1324         	|  0.019451       	|
on_batch_end                       	|  1.9924e-05     	|4900           	|  0.09763        	|  0.014343       	|
training_step_end                  	|  1.6849e-05     	|4900           	|  0.082562       	|  0.012129       	|
on_train_epoch_start               	|  0.00077706     	|25             	|  0.019427       	|  0.002854       	|
on_train_start                     	|  0.00088953     	|1              	|  0.00088953     	|  0.00013068     	|
on_epoch_start                     	|  3.0231e-05     	|25             	|  0.00075578     	|  0.00011103     	|
on_epoch_end                       	|  2.639e-05      	|25             	|  0.00065974     	|  9.6924e-05     	|
on_train_end                       	|  0.00049392     	|1              	|  0.00049392     	|  7.2563e-05     	|
on_fit_start                       	|  5.3681e-05     	|1              	|  5.3681e-05     	|  7.8864e-06     	|
on_train_dataloader                	|  3.2224e-05     	|1              	|  3.2224e-05     	|  4.7341e-06     	|
on_before_accelerator_backend_setup	|  1.0714e-05     	|1              	|  1.0714e-05     	|  1.574e-06      	|

[2022-01-21 18:11:56,979 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 18:11:57,876 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:11:57,887 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:12:46,090 INFO @src.logger.base_logger] 19 - Running script at src.test
[2022-01-21 18:12:46,994 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:12:47,006 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:13:42,304 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 18:13:43,201 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:13:43,214 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:13:43,525 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 18:13:43,526 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:13:43,527 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 18:13:44,495 INFO @pytorch_lightning.utilities.distributed] 1294 - GPU available: True, used: True
[2022-01-21 18:13:44,495 INFO @pytorch_lightning.utilities.distributed] 1297 - TPU available: False, using: 0 TPU cores
[2022-01-21 18:13:44,495 INFO @pytorch_lightning.utilities.distributed] 1300 - IPU available: False, using: 0 IPUs
[2022-01-21 18:13:44,495 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 18:13:44,495 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 18:13:44,574 INFO @src.logger.base_logger] 19 - Running script at src.train
[2022-01-21 18:13:45,471 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:13:45,482 DEBUG @git.cmd] 869 - Popen(['git', 'version'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:13:45,777 DEBUG @src.logger.base_logger] 23 - Detected device: cuda
[2022-01-21 18:13:45,778 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:13:45,778 INFO @src.logger.base_logger] 51 - CuDNN is enabled: True
[2022-01-21 18:13:46,281 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:13:46,284 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
[2022-01-21 18:13:46,751 INFO @src.logger.base_logger] 157 - Precision: 32
[2022-01-21 18:13:46,751 INFO @src.logger.base_logger] 158 - Train the mobilenetv3 model.
[2022-01-21 18:13:46,752 INFO @pytorch_lightning.utilities.seed] 65 - Global seed set to 1234
[2022-01-21 18:13:46,752 INFO @pytorch_lightning.plugins.training_type.ddp] 322 - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
[2022-01-21 18:13:46,753 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 1
[2022-01-21 18:13:46,759 INFO @torch.distributed.distributed_c10d] 196 - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-01-21 18:13:46,759 INFO @torch.distributed.distributed_c10d] 226 - Rank 0: Completed store-based barrier for 2 nodes.
[2022-01-21 18:13:46,760 INFO @pytorch_lightning.utilities.distributed] 328 - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 2 processes
----------------------------------------------------------------------------------------------------

[2022-01-21 18:13:46,764 INFO @torch.distributed.distributed_c10d] 226 - Rank 1: Completed store-based barrier for 2 nodes.
[2022-01-21 18:13:50,523 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 18:13:50,523 INFO @pytorch_lightning.accelerators.gpu] 54 - LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
[2022-01-21 18:13:50,617 DEBUG @git.cmd] 869 - Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/doni-lab-ai/Documenti/NeuralNetwork-project, universal_newlines=False, shell=None, istream=None)
[2022-01-21 18:13:50,751 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 18:13:50,758 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 464
[2022-01-21 18:13:50,765 DEBUG @urllib3.connectionpool] 227 - Starting new HTTP connection (1): localhost:8080
[2022-01-21 18:13:50,772 DEBUG @urllib3.connectionpool] 452 - http://localhost:8080 "POST /graphql HTTP/1.1" 200 368
[2022-01-21 18:13:53,931 INFO @pytorch_lightning.core.lightning] 1736 - 
  | Name          | Type             | Params
---------------------------------------------------
0 | net           | MobileNetV3      | 4.3 M 
1 | criterion     | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.142    Total estimated model params size (MB)
